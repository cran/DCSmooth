<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Bastian Schaefer" />


<title>DCSmooth</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">DCSmooth</h1>
<h4 class="author">Bastian Schaefer</h4>
<h4 class="date">18.10.2021</h4>


<div id="TOC">
<ul>
<li><a href="#introduction">1 Introduction</a></li>
<li><a href="#details-of-functions-methods-and-data">2 Details of Functions, Methods and Data</a>
<ul>
<li><a href="#functions">2.1 Functions</a>
<ul>
<li><a href="#set.options"><code>set.options()</code></a></li>
<li><a href="#dcs"><code>dcs()</code></a></li>
<li><a href="#surface.dcs"><code>surface.dcs()</code></a></li>
<li><a href="#sarma.sim"><code>sarma.sim()</code></a></li>
<li><a href="#sarma.est"><code>sarma.est()</code></a></li>
<li><a href="#sfarima.sim"><code>sfarima.sim()</code></a></li>
<li><a href="#sfarima.est"><code>sfarima.est()</code></a></li>
<li><a href="#kernel.assign"><code>kernel.assign()</code></a></li>
<li><a href="#kernel.list"><code>kernel.list()</code></a></li>
</ul></li>
<li><a href="#methods">2.2 Methods</a></li>
<li><a href="#data">2.3 Data</a></li>
</ul></li>
<li><a href="#application">3 Application</a>
<ul>
<li><a href="#defining-the-options">3.1 Defining the Options</a></li>
<li><a href="#application-of-the-dcs-with-iid.-errors">3.2 Application of the DCS with iid. errors</a>
<ul>
<li><a href="#kernel-regression-with-iid.-errors">Kernel Regression with iid. errors</a></li>
<li><a href="#local-polynomial-regression-with-iid.-errors">Local Polynomial regression with iid. errors</a></li>
</ul></li>
<li><a href="#application-of-the-dcs-with-sarma-errors">3.3 Application of the DCS with SARMA errors</a>
<ul>
<li><a href="#local-polynomial-regression-with-specified-sarma-order">Local Polynomial regression with specified SARMA order</a></li>
<li><a href="#local-polynomial-regression-with-automated-order-selection">Local Polynomial regression with automated order selection</a></li>
</ul></li>
<li><a href="#modeling-errors-with-long-memory">3.4 Modeling errors with long memory</a></li>
<li><a href="#estimation-of-derivatives">3.5 Estimation of derivatives</a></li>
</ul></li>
<li><a href="#mathematical-background">4 Mathematical Background</a>
<ul>
<li><a href="#double-conditional-smoothing">4.1 Double Conditional Smoothing</a></li>
<li><a href="#bandwidth-selection">4.2 Bandwidth Selection</a></li>
<li><a href="#boundary-modification">4.3 Boundary Modification</a></li>
<li><a href="#spatial-arma-processes">4.4 Spatial ARMA processes</a></li>
<li><a href="#estimation-of-sarma-processes">4.5 Estimation of SARMA processes</a>
<ul>
<li><a href="#estimation-of-a-separable-sarma-by-ml-estimation">Estimation of a separable SARMA by ML-estimation</a></li>
<li><a href="#least-squares-estimation-using-the-rss">Least squares estimation using the RSS</a></li>
<li><a href="#the-hannan-rissanen-algorithm">The Hannan-Rissanen Algorithm</a></li>
</ul></li>
</ul></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<!-- rmarkdown::render("DCSmooth.Rmd", output_format = "latex_document") -->
<div id="introduction" class="section level1">
<h1>1 Introduction</h1>
<p>This vignette describes the use of the <em>DCSmooth</em>-package and its functions. The <em>DCSmooth</em> package provides some tools for non- and semiparametric estimation of the mean surface <span class="math inline">\(m\)</span> of an observed sample of some function <span class="math display">\[y(x, t) = m(x, t) + \varepsilon(x, t).\]</span></p>
<p>This package is accompanying <span class="citation">Schäfer and Feng (2021)</span>. Boundary modification procedures for local polynomial smoothing are considered by <span class="citation">Feng and Schäfer (2021)</span>. For a more comprehensive and detailed description of the algorithms than in section 4, please refer to these papers.</p>
<p>The <em>DCSmooth</em> contains the following functions, methods and data sets:</p>
<table>
<colgroup>
<col width="25%" />
<col width="74%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"><span style="display: inline-block; width:170px">Functions</span></th>
<th align="left"><span style="display: inline-block; width:500px"> </span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>set.options()</code></td>
<td align="left">Define options for the <code>dcs()</code>-function.</td>
</tr>
<tr class="even">
<td align="left"><code>dcs()</code></td>
<td align="left">Nonparametric estimation of the expectation function of a matrix <code>Y</code>. Includes automatic iterative plug-in bandwidth selection.</td>
</tr>
<tr class="odd">
<td align="left"><code>surface.dcs()</code></td>
<td align="left">3d-plot for the surfaces of an <code>&quot;dcs&quot;</code>-object.</td>
</tr>
<tr class="even">
<td align="left"><code>sarma.sim()</code></td>
<td align="left">Simulate a SARMA-model.</td>
</tr>
<tr class="odd">
<td align="left"><code>sarma.est()</code></td>
<td align="left">Estimate the parameters of a SARMA-model.</td>
</tr>
<tr class="even">
<td align="left"><code>sfarima.sim()</code></td>
<td align="left">Simulate a SFARIMA-model.</td>
</tr>
<tr class="odd">
<td align="left"><code>sfarima.est()</code></td>
<td align="left">Estimate the parameters of a SFARIMA-model.</td>
</tr>
<tr class="even">
<td align="left"><code>kernel.assign()</code></td>
<td align="left">Assign a pointer to a kernel function.</td>
</tr>
<tr class="odd">
<td align="left"><code>kernel.list()</code></td>
<td align="left">Print list of kernels available in the package.</td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col width="25%" />
<col width="74%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"><span style="display: inline-block; width:170px">Methods/Generics</span></th>
<th align="left"><span style="display: inline-block; width:500px"> </span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>summary.dcs()</code></td>
<td align="left">Summary statistics for an object of class <code>&quot;dcs&quot;</code>.</td>
</tr>
<tr class="even">
<td align="left"><code>print.dcs()</code></td>
<td align="left">Print an object of class <code>&quot;dcs&quot;</code>.</td>
</tr>
<tr class="odd">
<td align="left"><code>plot.dcs()</code></td>
<td align="left">Plot method for an <code>&quot;dcs&quot;</code>-object, returns contour plot.</td>
</tr>
<tr class="even">
<td align="left"><code>residuals.dcs()</code></td>
<td align="left">Returns the residuals of the regression from an <code>&quot;dcs&quot;</code>-object.</td>
</tr>
<tr class="odd">
<td align="left"><code>print.summary_dcs()</code></td>
<td align="left">Print an object of class <code>&quot;summary_dcs&quot;</code>, which inherits from <code>summary.dcs()</code>.</td>
</tr>
<tr class="even">
<td align="left"><code>print.set_options()</code></td>
<td align="left">Prints an object of class <code>&quot;dcs_options&quot;</code>, which inherits from <code>set.options()</code></td>
</tr>
<tr class="odd">
<td align="left"><code>summary.sarma()</code></td>
<td align="left">Summary statistics for an object of class <code>&quot;sarma&quot;</code></td>
</tr>
<tr class="even">
<td align="left"><code>print.summary_sarma()</code></td>
<td align="left">Prints an object of class <code>&quot;summary_sarma&quot;</code>, which inherits from <code>summary.sarma()</code></td>
</tr>
<tr class="odd">
<td align="left"><code>summary.sfarima()</code></td>
<td align="left">Summary statistics for an object of class <code>&quot;sfarima&quot;</code></td>
</tr>
<tr class="even">
<td align="left"><code>print.summary_sfarima()</code></td>
<td align="left">Prints an object of class <code>&quot;summary_sfarima&quot;</code>, which inherits from <code>summary.sfarima()</code></td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col width="25%" />
<col width="74%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"><span style="display: inline-block; width:170px">Data</span></th>
<th align="left"><span style="display: inline-block; width:510px"> </span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>y.norm1</code></td>
<td align="left">A surface with a single gaussian peak.</td>
</tr>
<tr class="even">
<td align="left"><code>y.norm2</code></td>
<td align="left">A surface with two gaussian peaks.</td>
</tr>
<tr class="odd">
<td align="left"><code>y.norm3</code></td>
<td align="left">A surface with two gaussian ridges.</td>
</tr>
<tr class="even">
<td align="left"><code>temp.nunn</code></td>
<td align="left">Temperatures in Nunn, CO observed in 2020 in 5 minute intervals. (Source: NOAA)</td>
</tr>
<tr class="odd">
<td align="left"><code>temp.yuma</code></td>
<td align="left">Temperatures in Yuma, AZ observed in 2020 in 5 minute intervals. (Source: NOAA)</td>
</tr>
<tr class="even">
<td align="left"><code>wind.nunn</code></td>
<td align="left">Wind speed in Nunn, CO observed in 2020 in 5 minute intervals. (Source: NOAA)</td>
</tr>
<tr class="odd">
<td align="left"><code>wind.yuma</code></td>
<td align="left">Wind speed in Yuma, AZ observed in 2020 in 5 minute intervals. (Source: NOAA)</td>
</tr>
<tr class="even">
<td align="left"><code>returns.alv</code></td>
<td align="left">5 minute returns of Allianz SE from 2007 to 2010</td>
</tr>
<tr class="odd">
<td align="left"><code>volumes.alv</code></td>
<td align="left">5 minute volumes of Allianz SE from 2007 to 2010</td>
</tr>
</tbody>
</table>
</div>
<div id="details-of-functions-methods-and-data" class="section level1">
<h1>2 Details of Functions, Methods and Data</h1>
<div id="functions" class="section level2">
<h2>2.1 Functions</h2>
<div id="set.options" class="section level3 unnumbered">
<h3 class="unnumbered"><code>set.options()</code></h3>
<p>This auxiliary function is used to set the options for the <code>dcs</code> function. An object of class <code>dcs_options</code> is created and should be used as <code>dcs_options</code>- argument in the <code>dcs</code> function.</p>
<p>Arguments of <code>set.options()</code> are</p>
<ul>
<li><strong>type</strong> Specifies the regression type. Supported methods are kernel regression (<code>&quot;KR&quot;</code>) and local polynomial regression (<code>&quot;LP&quot;</code>), which is the default value.</li>
<li><strong>kerns</strong> A character vector of length 2 stating the identifiers for the kernels in each dimension to use. The first element corresponds to the smoothing conditional on rows, the second conditional on columns. The identifiers are of the form <span class="math inline">\(X\_k\mu\nu\)</span>, where <span class="math inline">\(X\)</span> indicates the smoothing method to use, either one of <code>M</code>, <code>MW</code> or <code>T</code>. The value <span class="math inline">\(k\)</span> is the kernel order, <span class="math inline">\(\mu\)</span> is the smoothness degree and <span class="math inline">\(\nu\)</span> the derivative estimated by the kernel, which must match the order of derivative <code>drv</code>. For more information on the kernels see section 4.3, a list of available kernels is given in A.1. The default kernels are <code>&quot;MW_220&quot;</code> for both dimensions.</li>
<li><strong>drv</strong> Derivative <span class="math inline">\((\nu_x, \nu_t)\)</span> of <span class="math inline">\(m(x,t)\)</span> to be estimated. Note that <span class="math inline">\(k \geq \nu + 2\)</span>, hence, only estimation of derivatives corresponding to kernels available is possible.</li>
<li><strong>var_model</strong> Specifies the model assumption and estimation method for the errors/innovations <span class="math inline">\(\varepsilon(x, t)\)</span> in the regression model. The form is given by <code>&quot;model_method&quot;</code> Currently available are
<ul>
<li><code>&quot;iid&quot;</code> (independently identically distributed errors with variance estimation from the residuals, set as default).</li>
<li><code>&quot;sarma_sep&quot;</code> (separable spatial ARMA (SARMA) process, two univariate processes in both directions are estimated via <code>stats::arima</code>).</li>
<li><code>&quot;sarma_HR&quot;</code> (fast estimation of an SARMA process by the Hannan-Rissanen algorithm).</li>
<li><code>&quot;sarma_RSS</code> (estimation of an separable SARMA process by numerical minimization of the RSS).</li>
<li><code>&quot;sfarima_RSS&quot;</code> (estimation of a separable spatial FARIMA (SFARIMA) model by numerical minimization of the RSS).</li>
</ul></li>
</ul>
<p>The models and estimation methods are described in more detail in Section 4.4.</p>
<blockquote>
<p>The option <strong>var_est</strong> with values <code>c(&quot;iid&quot;, &quot;qarma&quot;, &quot;sarma&quot;, &quot;lm&quot;)</code> has been replaced by <strong>var_model</strong>. For compatibility reasons, the option can still be used in <code>set.options</code> but will be converted to <strong>var_model</strong></p>
</blockquote>
<ul>
<li><strong>…</strong> Additional arguments passed to <code>set.options</code>. The default values of these options typically depend on other options and thus are put in an ellipsis. Accepted arguments are
<ul>
<li><strong>IPI_options</strong> Advanced options for tuning the parameters of the iterative plug-in algorithm of the bandwidth selection. These options include 2-element vectors for the inflation parameters (<code>infl_par</code>), the inflation exponents (<code>infl_exp</code>) and trimming parameters for stabilized estimation of the necessary derivatives (<code>trim</code>). Another option to further stabilize estimation of derivatives at the boundaries is the use of a constant estimation window at the boundaries setting the logical flag <code>const_window</code> to <code>TRUE</code>. The default values for the IPI-options depend partly on the regression type and error model selected and are given below. For convenience, the contents of <code>IPI_options</code> can be passed directly into the ellipsis <code>...</code> of <code>set.options()</code>.</li>
<li><strong>model_order</strong> controls the order of the parametric error term model if an SARMA or SFARIMA model is used. This can be either a list of the form <code>list(ar = c(1, 1), ma = c(1, 1))</code> (the default for SARMA and SFARIMA) specifying the model order, or any of <code>c(&quot;aic&quot;, &quot;bic&quot;, &quot;gpac&quot;)</code> specifying an order selection criterion. Note that <code>gpac</code> does not work under SFARIMA errors.</li>
<li><strong>order_max</strong> Controls the maximum order if an order selection process is chosen in <code>model_order</code>. Is a list of the form <code>list(ar = c(1, 1), ma = c(1, 1))</code> (the default).</li>
</ul></li>
</ul>
<p><code>set.options()</code> returns an object of class <code>&quot;dcs_options</code> including the following values</p>
<ul>
<li><strong>type</strong> Inherited from input.</li>
<li><strong>kerns</strong> Inherited from input.</li>
<li><strong>drv</strong> Inherited from input.</li>
<li><strong>p_order</strong> A numeric vector of length 2, computed from <code>drv</code> by <span class="math inline">\(p_k = \nu_k + 1, k = x, t\)</span>.</li>
<li><strong>var_model</strong> Inherited from input.</li>
<li><strong>IPI_options</strong> Options for the iterative-plug in algorithm for bandwidth selection. If unchanged, values are set conditional on <code>type</code> (see default values for <code>KR</code> and <code>LP</code> below).</li>
<li><strong>add_options</strong> A list containing the additional options <code>model_order</code> and <code>order_max</code> if available.</li>
</ul>
<blockquote>
<p>Every argument of the <code>set.options</code> function has a default value. Hence, just using <code>set.options()</code> will produce a complete set of options for double conditional smoothing regression in <code>dcs</code> (which is also implemented as default options in <code>dcs</code>, if the argument <code>dcs_options</code> is omitted).</p>
</blockquote>
<p>Default options for kernel regression (<code>type = &quot;KR&quot;</code>) are</p>
<pre><code>#&gt; dcs_options 
#&gt; --------------------------------------- 
#&gt; options for DCS   rows    cols 
#&gt; --------------------------------------- 
#&gt; type: kernel regression 
#&gt; kernels used:        MW_220  MW_220
#&gt; derivative:      0   0
#&gt; variance model:  
#&gt; ---------------------------------------
#&gt; IPI options:
#&gt; inflation parameters     2   1
#&gt; inflation exponents  0.5 0.5
#&gt; trim             0.05    0.05
#&gt; constant window width    FALSE
#&gt; ---------------------------------------</code></pre>
<p>Default options for local polynomial regression (<code>type = &quot;LP&quot;</code>) are</p>
<pre><code>#&gt; dcs_options 
#&gt; --------------------------------------- 
#&gt; options for DCS   rows    cols 
#&gt; --------------------------------------- 
#&gt; type: local polynomial regression 
#&gt; kernel order:        MW_220  MW_220
#&gt; derivative:      0   0
#&gt; polynomial order:    1   1
#&gt; variance model:  iid
#&gt; --------------------------------------- 
#&gt; IPI options:
#&gt; inflation parameters     2   1
#&gt; inflation exponents  auto     
#&gt; trim             0.05    0.05
#&gt; constant window width    FALSE
#&gt; ---------------------------------------</code></pre>
</div>
<div id="dcs" class="section level3 unnumbered">
<h3 class="unnumbered"><code>dcs()</code></h3>
<p>The <code>dcs()</code>-function is the main function of the package and includes IPI-bandwidth selection and non-parametric smoothing of the observations <code>Y</code> using the selected bandwidths. This function creates an object of class <code>dcs</code>, which includes the results of the DCS procedure.</p>
<p>Arguments of <code>dcs()</code> are</p>
<ul>
<li><strong>Y</strong> The matrix of observations to be smoothed via the DCS procedure. This matrix should only contain numeric values and no missing observations. For computational reasons, <code>Y</code> has to have at least five rows and columns, however, for reliable results the size should be larger.</li>
<li><strong>dcs_options</strong> The options used for the smoothing and bandwidth selection. This should be an object of class <code>&quot;dcs_options&quot;</code> created by <code>set.options()</code>. This argument is optional, if omitted, all options will be set to their default values from the <code>set.options()</code> function.</li>
<li><strong>h</strong> Either a two-value vector of positive numeric bandwidths or <code>&quot;auto&quot;</code> if bandwidth selection should be employed (the default).</li>
<li><strong>parallel</strong> A logical flag if parallelization should be used for computation of the smoothed surfaces and its derivatives. If the order of the variance model is automatically selected, parallelization affects also this.</li>
<li><strong>…</strong> Further arguments to be passed to the function. This includes the equidistant covariates <code>X</code> and <code>T</code> which should be ordered numerical vectors whose length matches the number of rows of <code>Y</code> for <code>X</code> and the number of columns of <code>Y</code> for <code>T</code>.</li>
</ul>
<p><code>dcs</code> returns an object of class <code>&quot;dcs</code> including the following values</p>
<ul>
<li><strong>X, T</strong> Vectors of covariates inherited from input or calculated to be equidistant on <span class="math inline">\([0,1]\)</span> if these are omitted in the input.</li>
<li><strong>Y</strong> Matrix of observations inherited from input.</li>
<li><strong>M</strong> Matrix of smoothed values. If the argument <code>h = &quot;auto</code> is used in <code>dcs</code>, the bandwidths are optimized via the IPI-algorithm, if <code>h</code> is set to fixed values, these bandwidth are used.</li>
<li><strong>R</strong> Matrix of residuals computed from <span class="math inline">\(R = Y - M\)</span>.</li>
<li><strong>h</strong> Bandwidths used for smoothing of <code>Y</code>. Either obtained by IPI bandwidth selection or given as argument in <code>dcs</code>.</li>
<li><strong>c_f</strong> The estimated variance factor used in the last iteration of the bandwidth selection algorithm. Is set to <code>NA</code>, if no bandwidth selection is used.</li>
<li><strong>var_est</strong> The estimated model obtained for the error terms (residuals) <span class="math inline">\(\varepsilon(x, t)\)</span>, i.e. the matrix <code>$R</code>. Output depends on the model specification used in <code>dcs_options$var_model</code>. For <code>var_model = &quot;iid&quot;</code>, it contains the estimated standard deviation of the residuals and an indicator for stationarity, which is true by assumption. For <code>dcs_options$var_model = c(&quot;sarma_sep&quot;, &quot;sarma_RSS&quot;, &quot;sarma_HR&quot;)</code>, it contains the estimated model in an object of class <code>&quot;sarma&quot;</code> including the coefficient matrices <code>$ar</code> and <code>$ma</code>, the standard deviation <code>$sigma</code> as well as an stationarity indicator <code>$stnry</code>. For <code>dcs_options$var_model = &quot;sfarima_RSS&quot;</code>, the output is of class <code>&quot;sfarima&quot;</code>, with similar contents as <code>&quot;sarma&quot;</code> and the addition of the estimated long memory parameter vector <code>$d</code>.</li>
<li><strong>dcs_options</strong> An object of class <code>&quot;dcs_options&quot;</code> containing the options used in the function.</li>
<li><strong>iterations</strong> An integer reporting the number of iterations of the IPI algorithm. Is set to <code>NA</code>, if no bandwidth selection is used.</li>
<li><strong>time_used</strong> A number reporting the time (in seconds) used for the IPI algorithm (total including all iterations). Is set to <code>NA</code>, if no bandwidth selection is used.</li>
</ul>
</div>
<div id="surface.dcs" class="section level3 unnumbered">
<h3 class="unnumbered"><code>surface.dcs()</code></h3>
<p>This function is a convenient wrapper for the <code>plotly::plot_ly()</code> function of the <em>plotly</em> package, for easy displaying of the considered surfaces. Direct plotting is available for any object of class <code>&quot;dcs&quot;</code> or any numeric matrix <code>Y</code>.</p>
<p>Arguments of <code>surface.dcs()</code> are</p>
<ul>
<li><strong>Y</strong> Either an object of class <code>&quot;dcs&quot;</code>, inheriting from a call to <code>dcs()</code> or a numeric matrix, which is then directly passed to <code>plotly::plot_ly()</code>.</li>
<li><strong>trim</strong> A two-value vector which gives the percentage (between 0 and 0.5) of boundaries to leave out in the plot. Useful, if estimation at boundaries is unstable and has too high values compared to the inner, e.g. useful when estimation of derivatives is considered.</li>
<li><strong>plot_choice</strong> Only used, if <code>Y</code> is an object of class <code>&quot;dcs&quot;</code>. Specifies the surface to be plotted, <code>1</code> for the original observations, <code>2</code> for the smoothed surface and <code>3</code> for the residual surface. If <code>plot_choice</code> is omitted and <code>Y</code> is an <code>&quot;dcs&quot;</code>-object, a choice dialogue will be prompted to the console, which asks to state one of the available options.</li>
<li><strong>…</strong> Further arguments to be passed to the <code>plotly::plot_ly()</code> function.</li>
</ul>
<p><code>surface.dcs()</code> returns an object of class <code>&quot;plotly&quot;</code>.</p>
</div>
<div id="sarma.sim" class="section level3 unnumbered">
<h3 class="unnumbered"><code>sarma.sim()</code></h3>
<p>Simulation of a spatial ARMA process (SARMA). This function returns an object of class <code>&quot;sarma&quot;</code> with attribute <code>&quot;subclass&quot; = &quot;sim&quot;</code>. The simulated innovations are created from a normal distribution with specified standard deviation <span class="math inline">\(\sigma\)</span>. This function uses a burn-in period for more consistent results.</p>
<p>Arguments of <code>sarma.sim()</code> are</p>
<ul>
<li><strong>n_x</strong>, <strong>n_t</strong> The dimension of the resulting matrix of observations, where <code>n_x</code> specifies the number of rows and <code>n_t</code> the number of columns. Initially, a matrix <code>Y&#39;</code> of size <span class="math inline">\(2 n_x \times 2 n_t\)</span> is simulated, for which simulation points with <span class="math inline">\(i \leq n_x\)</span> or <span class="math inline">\(j \leq n_t\)</span> are discarded (burn-in period).</li>
<li><strong>model</strong> A list containing the model parameters to be used in the simulation. The argument should be a list of the form <code>list(ar, ma, sigma)</code>. The values <code>ar</code> and <code>ma</code> are matrices of size <span class="math inline">\((p_x + 1) \times (p_t + 1)\)</span> respective <span class="math inline">\((q_x + 1) \times (q_t + 1)\)</span> and contain the coefficients in ascending lag order, so that the upper left entry is equal to 1 (for lag 0 in both dimensions). The standard deviation of the iid. innovations with zero mean is <code>sigma</code>, which should be a single positive number. See the examples in the application part 3.3 and the notation of SARMA models in Section 4.4.</li>
</ul>
<p><code>sarma.sim()</code> returns an object of class <code>&quot;sarma&quot;</code> with attribute <code>&quot;subclass&quot; = &quot;sim&quot;</code> including the following values:</p>
<ul>
<li><strong>Y</strong> The matrix of simulated values with size <span class="math inline">\(n_x \times n_t\)</span> (determined by function arguments <code>n_x</code>, <code>n_t</code>). The matrix <span class="math inline">\(Y\)</span> is the lower left <span class="math inline">\(n_x \times n_t\)</span> submatrix of the actually simulated matrix <span class="math inline">\(Y&#39;\)</span> of size <span class="math inline">\(2 n_x \times 2 n_t\)</span> to avoid effects from setting the initial values (burn-in period).</li>
<li><strong>innov</strong> The <span class="math inline">\(n_x \times n_t\)</span> matrix of iid. normally distributed innovations/errors of the SARMA model with zero mean and variance <span class="math inline">\(\sigma^2\)</span> (determined by the function argument <code>model\$sigma</code>). As with <code>Y</code>, the original matrix has size <span class="math inline">\(2 n_x \times 2 n_t\)</span>.</li>
<li><strong>model</strong> The model used for simulation, inherited from input.</li>
<li><strong>stnry</strong> A flag indicating whether the simulated process is stationary.</li>
</ul>
</div>
<div id="sarma.est" class="section level3 unnumbered">
<h3 class="unnumbered"><code>sarma.est()</code></h3>
<p>Estimate the parameters of an SARMA of given order. It returns an object of class <code>&quot;sarma&quot;</code> with attribute <code>&quot;subclass&quot; = &quot;est&quot;</code>. For estimation, three methods are available.</p>
<p>Arguments of <code>sarma.est()</code> are</p>
<ul>
<li><strong>Y</strong> A (demeaned) matrix of observations, which contains only numeric values and no missing observations.</li>
<li><strong>method</strong> A character string specifying the method for estimation. Currently supported methods are the Hannan-Rissanen algorithm (<code>&quot;HR&quot;</code>), a separable model using two univariate estimations via <code>stats::arima</code> (<code>&quot;sep&quot;</code>) and a separable model which minimizes the residual sum of squares (RSS) of the model (<code>&quot;RSS&quot;</code>).</li>
<li><strong>model_order</strong> A list specifying the order of the SARMA to be estimated. This list should be of the form <code>list(ar = c(1, 1), ma = c(1, 1))</code>, where all orders should be non-negative integers. A SARMA<span class="math inline">\(((1,1), (1,1))\)</span> model is estimated by default, if <code>model_order</code> is omitted.</li>
</ul>
<p><code>sarma.est()</code> returns an object of class <code>&quot;sarma&quot;</code> with attribute <code>&quot;subclass&quot; = &quot;est&quot;</code> including the following values:</p>
<ul>
<li><strong>Y</strong> The matrix of observations inherited from input.</li>
<li><strong>innov</strong> The matrix of estimated innovations (residuals).</li>
<li><strong>model</strong> A list of estimated model coefficients containing the matrices <code>ar</code> of autoregressive coefficients, the matrix <code>ma</code> of moving average coefficients as well as the standard deviation of residuals <code>sigma</code>.</li>
<li><strong>stnry</strong> A flag indicating whether the estimated process is stationary.</li>
</ul>
</div>
<div id="sfarima.sim" class="section level3 unnumbered">
<h3 class="unnumbered"><code>sfarima.sim()</code></h3>
<p>Simulation of a (separable) spatial fractional ARIMA (SFARIMA) process. This function returns an object of class <code>&quot;sfarima&quot;</code> with attribute <code>&quot;subclass&quot; = &quot;sim&quot;</code>. The simulated innovations are created from a normal distribution with specified standard deviation <span class="math inline">\(\sigma\)</span>. This function uses a burn-in period for more consistent results.</p>
<p>Arguments of <code>sfarima.sim()</code> are</p>
<ul>
<li><strong>n_x</strong>, <strong>n_t</strong> The dimension of the resulting matrix of observations, where <code>n_x</code> specifies the number of rows and <code>n_t</code> the number of columns. Initially, a matrix <code>Y&#39;</code> of size <span class="math inline">\(2 n_x \times 2 n_t\)</span> is simulated, for which simulation points with <span class="math inline">\(i \leq n_x\)</span> or <span class="math inline">\(j \leq n_t\)</span> are discarded (burn-in period).</li>
<li><strong>model</strong> A list containing the model parameters to be used in the simulation of the form <code>list(ar, ma, d, sigma)</code>. The values <code>ar</code> and <code>ma</code> are matrices of size <span class="math inline">\((p_x + 1) \times (p_t + 1)\)</span> respective <span class="math inline">\((q_x + 1) \times (q_t + 1)\)</span> and containing the coefficients in ascending lag order, so that the upper left entry is equal to 1 (for lag 0 in both dimensions). The long-memory parameters <span class="math inline">\(d_x, d_t\)</span> are stored in <code>d</code>, a numerical vector of length 2, with <span class="math inline">\(0 &lt; d_x, d_t &lt; 0.5\)</span>. The standard deviation of the iid. innovations with zero mean is <code>sigma</code>, which should be a single positive number. See the examples in the application part 3.4 and the notation of the short memory SARMA part in Section 4.4.</li>
</ul>
<p><code>sfarima.sim()</code> returns an object of class <code>&quot;sfarima&quot;</code> with attribute <code>&quot;subclass&quot; = &quot;sim&quot;</code> including the following values:</p>
<ul>
<li><strong>Y</strong> The matrix of simulated values with size <span class="math inline">\(n_x \times n_t\)</span> (determined by function arguments <code>n_x</code>, <code>n_t</code>). The matrix <span class="math inline">\(Y\)</span> is the lower left <span class="math inline">\(n_x \times n_t\)</span> submatrix of the actually simulated matrix <span class="math inline">\(Y&#39;\)</span> of size <span class="math inline">\(2 n_x \times 2 n_t\)</span> to avoid effects from setting the initial values (burn-in period).</li>
<li><strong>innov</strong> The <span class="math inline">\(n_x \times n_t\)</span> matrix of iid. normally distributed innovations/errors of the SFARIMA model with zero mean and variance <span class="math inline">\(\sigma^2\)</span> (determined by the function argument <code>model\$sigma</code>). As with <code>Y</code>, the original matrix has size <span class="math inline">\(2 n_x \times 2 n_t\)</span>.</li>
<li><strong>model</strong> The model used for simulation, inherited from input.</li>
<li><strong>stnry</strong> A flag indicating whether the simulated process is stationary.</li>
</ul>
</div>
<div id="sfarima.est" class="section level3 unnumbered">
<h3 class="unnumbered"><code>sfarima.est()</code></h3>
<p>Estimation of an SFARIMA process. This function minimizes the residual sum of squares (RSS) to estimate the SFARIMA-parameters of a given order. It returns an object of class <code>&quot;sfarima&quot;</code> with attribute <code>&quot;subclass&quot; = &quot;est&quot;</code>.</p>
<p>Arguments of <code>sfarima.est()</code> are</p>
<ul>
<li><strong>Y</strong> A (demeaned) matrix of observations, which contains only numeric values and no missing observations.</li>
<li><strong>model_order</strong> A list specifying the order of the SFARIMA to be estimated. This list should be of the form <code>list(ar = c(1, 1), ma = c(1, 1))</code>. All orders should be non-negative integers. A SFARIMA<span class="math inline">\(((1,1), (1,1))\)</span> model is estimated by default, if <code>model_order</code> is omitted.</li>
</ul>
<p><code>sfarima.est()</code> returns an object of class <code>&quot;sfarima&quot;</code> with attribute <code>&quot;subclass&quot; = &quot;est&quot;</code> including the following values:</p>
<ul>
<li><strong>Y</strong> The matrix of observations inherited from input.</li>
<li><strong>innov</strong> The matrix of estimated innovations (residuals).</li>
<li><strong>model</strong> A list of estimated model coefficients containing the matrices <code>ar</code> of autoregressive coefficients, the matrix <code>ma</code> of moving average coefficients as well as the vector <code>d</code> holding the long-memory parameters and the standard deviation of residuals <code>sigma</code>.</li>
<li><strong>stnry</strong> A flag indicating whether the estimated process is stationary.</li>
</ul>
</div>
<div id="kernel.assign" class="section level3 unnumbered">
<h3 class="unnumbered"><code>kernel.assign()</code></h3>
<p>This function sets an external pointer to a specified boundary kernel available in the DCSmooth package. These kernels are functions <span class="math inline">\(K(u, q)\)</span>, where <span class="math inline">\(u\)</span> is a vector on <span class="math inline">\([q, -1]\)</span> and <span class="math inline">\(q \in [0, 1]\)</span>. The boundary kernels are as proposed by <span class="citation">Müller and Wang (1994)</span>, <span class="citation">Müller (1991)</span> and constructed via the method described in <span class="citation">Feng and Schäfer (2021)</span>. Available types are Müller-Wang (<code>MW</code>), Müller (<code>M</code>) and truncated kernels (<code>T</code>).</p>
<p>Arguments of <code>kernel.assign()</code> are</p>
<ul>
<li><strong>kernel_id</strong> The identifier for the kernel to be assigned. It is a character string of the form <code>&quot;X_abc&quot;</code>, where <code>X</code> is specifies the type (<code>MW</code>, <code>M</code>, <code>T</code>), <code>a</code> i the kernel order <span class="math inline">\(k\)</span>, <code>b</code> is the degree of smoothness <span class="math inline">\(\mu\)</span> and <code>c</code> is the order of derivative <span class="math inline">\(\nu\)</span>. A list of currently usable kernel identifiers can be accessed with the function <code>kernel.list()</code>.</li>
</ul>
<p><code>kernel.assign()</code> returns an object of class <code>&quot;function&quot;</code>, which points to a precompiled kernel function.</p>
</div>
<div id="kernel.list" class="section level3 unnumbered">
<h3 class="unnumbered"><code>kernel.list()</code></h3>
<p><code>kernel.list()</code> prints the available identifiers for use in <code>kernel.assign()</code>.</p>
<p>The argument of <code>kernel.list()</code> is</p>
<ul>
<li><strong>print</strong> A logical value indicating if the list of available kernels should be printed to the console.</li>
</ul>
<p><code>kernel.list()</code> returns a list including the available kernels as character strings, if the argument is <code>print = FALSE</code>.</p>
<p>Available kernels are</p>
<table>
<thead>
<tr class="header">
<th><span class="math inline">\(k\)</span></th>
<th><span class="math inline">\(\mu\)</span></th>
<th><span class="math inline">\(\nu\)</span></th>
<th>Truncated Kernels</th>
<th>Müller Kernels</th>
<th>Müller-Wang Kernels</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>0</td>
<td>0</td>
<td></td>
<td><code>M_200</code></td>
<td><code>MW_200</code></td>
</tr>
<tr class="even">
<td>2</td>
<td>1</td>
<td>0</td>
<td></td>
<td><code>M_210</code></td>
<td><code>MW_210</code></td>
</tr>
<tr class="odd">
<td>2</td>
<td>2</td>
<td>0</td>
<td><code>T_220</code></td>
<td><code>M_220</code></td>
<td><code>MW_220</code></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>3</td>
<td>2</td>
<td>1</td>
<td><code>T_321</code></td>
<td><code>M_321</code></td>
<td><code>MW_320</code></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>4</td>
<td>2</td>
<td>0</td>
<td><code>T_420</code></td>
<td><code>M_420</code></td>
<td><code>MW_420</code></td>
</tr>
<tr class="even">
<td>4</td>
<td>2</td>
<td>1</td>
<td></td>
<td><code>M_421</code></td>
<td><code>MW_421</code></td>
</tr>
<tr class="odd">
<td>4</td>
<td>2</td>
<td>2</td>
<td><code>T_422</code></td>
<td><code>M_422</code></td>
<td><code>MW_422</code></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="methods" class="section level2">
<h2>2.2 Methods</h2>
<p>The <em>DCSmooth</em> package contains the following methods</p>
<table>
<thead>
<tr class="header">
<th align="left"><span style="display: inline-block; width:170px">Function</span></th>
<th align="left"><span style="display: inline-block; width:500px">Methods/Generics available</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>dcs_options</code></td>
<td align="left"><code>print</code>, <code>summary</code></td>
</tr>
<tr class="even">
<td align="left"><code>dcs</code></td>
<td align="left"><code>plot</code>, <code>print</code>, <code>print.summary</code>, <code>residuals</code>, <code>summary</code></td>
</tr>
<tr class="odd">
<td align="left"><code>sarma</code></td>
<td align="left"><code>print.summary</code>, <code>summary</code></td>
</tr>
<tr class="even">
<td align="left"><code>sfarima</code></td>
<td align="left"><code>print.summary</code>, <code>summary</code></td>
</tr>
</tbody>
</table>
</div>
<div id="data" class="section level2">
<h2>2.3 Data</h2>
<p>This package contains three simulated example data sets and six data sets of environmental spatial time series.</p>
<p>Each of the three simulated example data sets is a matrix of size <span class="math inline">\(101 \times 101\)</span> computed on <span class="math inline">\([0,1]^2\)</span> for the following functions, where <span class="math inline">\(N(\mu, \Sigma)\)</span> is the bivariate normal distribution with mean vector <span class="math inline">\(\mu\)</span> and covariance matrix <span class="math inline">\(\Sigma\)</span>:</p>
<ul>
<li><strong>y.norm1</strong> <span class="math display">\[ N \left( \begin{pmatrix} 0.5 \\ 0.5 \end{pmatrix}, \begin{pmatrix} 0.05 &amp; 0 \\ 0 &amp; 0.05 \end{pmatrix} \right)\]</span></li>
<li><strong>y.norm2</strong> <span class="math display">\[ N \left( \begin{pmatrix} 0.5 \\ 0.3 \end{pmatrix}, \begin{pmatrix} 0.1 &amp; 0 \\ 0 &amp; 0.1 \end{pmatrix} \right) + \mathcal{N} \left( \begin{pmatrix} 0.2 \\ 0.8 \end{pmatrix}, \begin{pmatrix} 0.05 &amp; 0 \\ 0 &amp; 0.05 \end{pmatrix} \right) \]</span></li>
<li><strong>y.norm3</strong> <span class="math display">\[ N \left( \begin{pmatrix} 0.25 \\ 0.75 \end{pmatrix}, \begin{pmatrix} 0.01 &amp; 0 \\ 0 &amp; -0.1 \end{pmatrix} \right) + \mathcal{N} \left( \begin{pmatrix} 0.75 \\ 0.5 \end{pmatrix}, \begin{pmatrix} 0.01 &amp; 0 \\ 0 &amp; -0.1 \end{pmatrix} \right)\]</span></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># surface.dcs(y.norm1)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># surface.dcs(y.norm2)</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># surface.dcs(y.norm3)</span></span></code></pre></div>
<p>The environmental application data sets feature the temperature and wind speed surfaces of Nunn, CO (<code>temp.nunn</code>, <code>wind.nunn</code>) and Yuma, AZ (<code>temp.yuma</code>, <code>wind.yuma</code>). The observations are taken in 2020 in 5-minute intervals. The temperatures are given in <em>Celsius</em> and wind speed is given in <em>m/s</em>. All data sets consist therefore of 288 columns (the intraday observations) and 366 rows (the days). The data is taken from the U.S. Climate Reference Network database at <a href="https://www.ncdc.noaa.gov/crn/qcdatasets.html">www.ncdc.noaa.gov</a>. (see Diamond et al., 2013)</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># surface.dcs(temp.nunn)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># surface.dcs(temp.yuma)</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># surface.dcs(wind.nunn)</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># surface.dcs(wind.yuma)</span></span></code></pre></div>
<p>For examples of financial applications, the return and volume data of German insurance company Allianz SE is available in the package. The data is aggregated to the 5-minute level over the years 2007-2010, hence, the financial crisis 2008 is covered. The matrices consist of 1016 rows representing the days and 101 (returns) respective 102 (volumes) columns for the intraday 5-minute intervals.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># surface.dcs(returns.alv)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># surface.dcs(volumes.alv)</span></span></code></pre></div>
</div>
</div>
<div id="application" class="section level1">
<h1>3 Application</h1>
<p>The application of the package is demonstrated at the example of the simulated function <code>y.norm1</code>, which represents a gaussian peak on <span class="math inline">\([0,1]^2\)</span> with <span class="math inline">\(n_x = n_t = 101\)</span> evaluation points. Different models are simulated and estimation using <code>dcs</code> is demonstrated. Whenever default options are used, they are not explicitly used as function arguments, instead only when deviating from the defaults, the options are changed.</p>
<blockquote>
<p>In order to keep the file size manageable, the <code>surface.dcs</code> commands in this vignette are commented out. Run the complete code used in section 3 of this vignette by <code>demo(&quot;DCS_demo&quot;, package = &quot;DCSmooth&quot;)</code>, but note that it might take some time.</p>
</blockquote>
<div id="defining-the-options" class="section level2">
<h2>3.1 Defining the Options</h2>
<p>In order to set specific options use the <code>set.options()</code> function to create an object of class <code>&quot;dcs_options&quot;</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>opt1 <span class="ot">=</span> <span class="fu">set.options</span>(<span class="at">type =</span> <span class="st">&quot;KR&quot;</span>, <span class="at">kerns =</span> <span class="fu">c</span>(<span class="st">&quot;M_220&quot;</span>, <span class="st">&quot;M_422&quot;</span>), <span class="at">drv =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">var_model =</span> <span class="st">&quot;sarma_RSS&quot;</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">IPI_options =</span> <span class="fu">list</span>(<span class="at">trim =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>), <span class="at">infl_par =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">infl_exp =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">0.7</span>), </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">const_window =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">model_order =</span> <span class="fu">list</span>(<span class="at">ar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">ma =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(opt1)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dcs_options </span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------- </span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; options for DCS   rows    cols </span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------- </span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; type: kernel regression </span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; kernels used:        M_220   M_422</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; derivative:      0   2</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; variance model:  </span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; IPI options:</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; inflation parameters     1   1</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; inflation exponents  0.7 0.7</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; trim             0.1 0.1</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; constant window width    TRUE</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(opt1)</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;dcs_options&quot;</span></span></code></pre></div>
<p>The contents of the advanced option <code>IPI_options</code> can be set directly as argument in <code>set.options()</code>. Changing these options might lead to non convergent bandwidths.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>opt2 <span class="ot">=</span> <span class="fu">set.options</span>(<span class="at">type =</span> <span class="st">&quot;KR&quot;</span>, <span class="at">kerns =</span> <span class="fu">c</span>(<span class="st">&quot;M_220&quot;</span>, <span class="st">&quot;M_422&quot;</span>), <span class="at">drv =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">var_model =</span> <span class="st">&quot;sarma_RSS&quot;</span>, <span class="at">trim =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>),</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">infl_par =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">infl_exp =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">0.7</span>), </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">const_window =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">model_order =</span> <span class="fu">list</span>(<span class="at">ar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">ma =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(opt2)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dcs_options </span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------- </span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; options for DCS   rows    cols </span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------- </span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; type: kernel regression </span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; kernels used:        M_220   M_422</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; derivative:      0   2</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; variance model:  </span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; IPI options:</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; inflation parameters     1   1</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; inflation exponents  0.7 0.7</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; trim             0.1 0.1</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; constant window width    TRUE</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(opt2)</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;dcs_options&quot;</span></span></code></pre></div>
<p>When using a model selection procedure, the additional option <code>order_max</code> is available:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>opt3 <span class="ot">=</span> <span class="fu">set.options</span>(<span class="at">var_model =</span> <span class="st">&quot;sarma_sep&quot;</span>, <span class="at">model_order =</span> <span class="st">&quot;bic&quot;</span>,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">order_max =</span> <span class="fu">list</span>(<span class="at">ar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ma =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>)))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(opt3)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dcs_options </span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------- </span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; options for DCS   rows    cols </span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------- </span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; type: local polynomial regression </span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; kernel order:        MW_220  MW_220</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; derivative:      0   0</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; polynomial order:    1   1</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; variance model:  sarma_sep</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------- </span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; IPI options:</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; inflation parameters     2   1</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; inflation exponents  auto     </span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; trim             0.05    0.05</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; constant window width    FALSE</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------</span></span></code></pre></div>
</div>
<div id="application-of-the-dcs-with-iid.-errors" class="section level2">
<h2>3.2 Application of the DCS with iid. errors</h2>
<p>The example data set is simulated by using iid. errors:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># surface.dcs(y.norm1)</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>y_iid <span class="ot">=</span> y.norm1 <span class="sc">+</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">101</span><span class="sc">^</span><span class="dv">2</span>), <span class="at">nrow =</span> <span class="dv">101</span>, <span class="at">ncol =</span> <span class="dv">101</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># surface.dcs(y_iid)</span></span></code></pre></div>
<div id="kernel-regression-with-iid.-errors" class="section level3 unnumbered">
<h3 class="unnumbered">Kernel Regression with iid. errors</h3>
<p>While local linear regression has some clear advantages over kernel regression, kernel regression is the faster method.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>opt_iid_KR <span class="ot">=</span> <span class="fu">set.options</span>(<span class="at">type =</span> <span class="st">&quot;KR&quot;</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>dcs_iid_KR <span class="ot">=</span> <span class="fu">dcs</span>(y_iid, opt_iid_KR)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>dcs_iid_KR</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dcs </span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DCS with automatic bandwidth selection:</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Selected Bandwidths:</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      h_x: 0.18875 </span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      h_t: 0.19282 </span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Variance Factor:</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      c_f: 1 </span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co"># print options used for DCS procedure</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>dcs_iid_KR<span class="sc">$</span>dcs_options</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dcs_options </span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------- </span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; options for DCS  rows    cols </span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------- </span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; type: kernel regression </span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; kernels used:        MW_220  MW_220</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; derivative:      0   0</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; variance model:  iid</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="co"># plot regression surface</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="co"># surface.dcs(dcs_iid_KR, plot_choice = 2)</span></span></code></pre></div>
<p>The summary of the <code>&quot;dcs&quot;</code>-object provides some more detailed information:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dcs_iid_KR)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; summary_dcs </span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DCS with automatic bandwidth selection:</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Results of kernel regression:</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimated Bandwidths:     h_x:    0.1888 </span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           h_t:    0.1928 </span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Variance Factor:      c_f:    1 </span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Iterations:           4 </span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time used (seconds):      0.03123 </span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Variance Model:   iid </span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma:    0.9968943 </span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; stationary:  TRUE</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; See used parameter with &quot;$dcs_options&quot;.</span></span></code></pre></div>
</div>
<div id="local-polynomial-regression-with-iid.-errors" class="section level3 unnumbered">
<h3 class="unnumbered">Local Polynomial regression with iid. errors</h3>
<p>This is the default method, specification of options is not necessary. Note that local polynomial regression requires the bandwidth to cover at least the number of observations of the polynomial order plus one. For small bandwidths or too few observation points in one dimension, local polynomial regression might fail (“Bandwidth h must be larger for local polynomial regression.”). It is suggested to use kernel regression in this case.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>dcs_LP_iid <span class="ot">=</span> <span class="fu">dcs</span>(y_iid)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>dcs_LP_iid</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dcs </span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DCS with automatic bandwidth selection:</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Selected Bandwidths:</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      h_x: 0.1941 </span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      h_t: 0.20778 </span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Variance Factor:</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      c_f: 1.0003 </span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dcs_LP_iid)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; summary_dcs </span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DCS with automatic bandwidth selection:</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Results of local polynomial regression:</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimated Bandwidths:     h_x:    0.1941 </span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           h_t:    0.2078 </span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Variance Factor:      c_f:    1 </span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Iterations:           4 </span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time used (seconds):      0.04686 </span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Variance Model:   iid </span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma:    0.9970611 </span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; stationary:  TRUE</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; See used parameter with &quot;$dcs_options&quot;.</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a><span class="co"># plot regression surface</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="co"># surface.dcs(dcs_LP_iid, plot_choice = 2)</span></span></code></pre></div>
</div>
</div>
<div id="application-of-the-dcs-with-sarma-errors" class="section level2">
<h2>3.3 Application of the DCS with SARMA errors</h2>
<p>A matrix containing innovations following a SARMA<span class="math inline">\(((p_x, p_t), (q_x, q_t))\)</span> process can be obtained by using the <code>sarma.sim()</code> function. We use the following SARMA<span class="math inline">\(((1, 1), (1, 1))\)</span>-process as example: <span class="math display">\[
AR = \begin{pmatrix} 1 &amp; 0.4 \\ -0.3 &amp; -0.12 \end{pmatrix},
\quad
MA = \begin{pmatrix} 1 &amp; -0.5 \\ -0.2 &amp; 0.1 \end{pmatrix}
\quad \text{ and } \quad
\sigma^2 = 0.25
\]</span></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ar_mat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.12</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>ma_mat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="fl">0.2</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.1</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>sigma  <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="fl">0.25</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>model_list <span class="ot">=</span> <span class="fu">list</span>(<span class="at">ar =</span> ar_mat, <span class="at">ma =</span> ma_mat, <span class="at">sigma =</span> sigma)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>sim_sarma <span class="ot">=</span> <span class="fu">sarma.sim</span>(<span class="at">n_x =</span> <span class="dv">101</span>, <span class="at">n_t =</span> <span class="dv">101</span>, <span class="at">model =</span> model_list)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># SARMA observations</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>y_sarma <span class="ot">=</span> y.norm1 <span class="sc">+</span> sim_sarma<span class="sc">$</span>Y</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># surface.dcs(y_sarma)</span></span></code></pre></div>
<p>Estimation of an SARMA process for a given order is implemented via the <code>sarma.est()</code> function (note that the simulated matrix can be accessed via <code>$Y</code>):</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>est_sarma <span class="ot">=</span> <span class="fu">sarma.est</span>(sim_sarma<span class="sc">$</span>Y, <span class="at">method =</span> <span class="st">&quot;HR&quot;</span>,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">model_order =</span> <span class="fu">list</span>(<span class="at">ar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">ma =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(est_sarma)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimation of SARMA((1,1),(1,1))</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma:    0.5008 </span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; stationary:   TRUE </span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ar:</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         lag 0  lag 1</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 0  1.0000 0.4042</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 1 -0.3051 0.1291</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ma:</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         lag 0    lag 1</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 0  1.0000 -0.49690</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 1 -0.1804  0.07785</span></span></code></pre></div>
<div id="local-polynomial-regression-with-specified-sarma-order" class="section level3 unnumbered">
<h3 class="unnumbered">Local Polynomial regression with specified SARMA order</h3>
<p>The <code>dcs()</code>-command is used with the default SARMA<span class="math inline">\(((1, 1), (1, 1))\)</span> model (correctly specified) and with an SARMA<span class="math inline">\(((1, 1), (0, 0))\)</span> (i.e. SAR<span class="math inline">\((1, 1)\)</span>) model. The chosen estimation procedure is <code>&quot;sep&quot;</code>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SARMA((1, 1), (1, 1))</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>opt_sarma_1 <span class="ot">=</span> <span class="fu">set.options</span>(<span class="at">var_model =</span> <span class="st">&quot;sarma_sep&quot;</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>dcs_sarma_1 <span class="ot">=</span> <span class="fu">dcs</span>(y_sarma, opt_sarma_1)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dcs_sarma_1<span class="sc">$</span>var_est)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimation of SARMA((1,1),(1,1))</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma:    0.5441 </span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; stationary:   TRUE </span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ar:</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         lag 0   lag 1</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 0  1.0000  0.5003</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 1 -0.5246 -0.2624</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ma:</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         lag 0    lag 1</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 0  1.0000 -0.47000</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 1 -0.1524  0.07165</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="co"># SARMA((1, 1), (0, 0))</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Use &quot;sarma_HR&quot; as it includes fast Yule-Walker estimation</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>opt_sarma_2 <span class="ot">=</span> <span class="fu">set.options</span>(<span class="at">var_model =</span> <span class="st">&quot;sarma_HR&quot;</span>,</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>                          <span class="at">model_order =</span> <span class="fu">list</span>(<span class="at">ar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">ma =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>dcs_sarma_2 <span class="ot">=</span> <span class="fu">dcs</span>(y_sarma, opt_sarma_2)</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dcs_sarma_2<span class="sc">$</span>var_est)</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimation of SARMA((1,1),(0,0))</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma:    0.5331 </span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; stationary:   TRUE </span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ar:</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        lag 0   lag 1</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 0  1.000 0.63580</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 1 -0.176 0.09775</span></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ma:</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       lag 0</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 0     1</span></span></code></pre></div>
</div>
<div id="local-polynomial-regression-with-automated-order-selection" class="section level3 unnumbered">
<h3 class="unnumbered">Local Polynomial regression with automated order selection</h3>
<p>Automated order selection is used with <code>model_order = c(&quot;aic&quot;, &quot;bic&quot;, &quot;gpac&quot;)</code> in <code>set.options()</code>. The first one minimizes the AIC, the second one the BIC and the third uses a generalized partial autocorrelation function for order selection (not available for SFARIMA estimation). Order selection for large data sets is slowly in general, however, the <code>&quot;gpac&quot;</code> might be slightly faster than the other two. If automatic order selection is used, the argument <code>order_max</code> sets the maximum orders to be tested in the same way as <code>model_order</code> is usually defined as a list.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># BIC</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>opt_sarma_3 <span class="ot">=</span> <span class="fu">set.options</span>(<span class="at">var_model =</span> <span class="st">&quot;sarma_HR&quot;</span>, <span class="at">model_order =</span> <span class="st">&quot;bic&quot;</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">order_max =</span> <span class="fu">list</span>(<span class="at">ar =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="at">ma =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>)))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>dcs_sarma_3 <span class="ot">=</span> <span class="fu">dcs</span>(y_sarma, opt_sarma_3)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dcs_sarma_3<span class="sc">$</span>var_est)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimation of SARMA((1,1),(1,1))</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma:    0.4997 </span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; stationary:   TRUE </span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ar:</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         lag 0  lag 1</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 0  1.0000 0.4031</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 1 -0.3083 0.1271</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ma:</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         lag 0    lag 1</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 0  1.0000 -0.50190</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 1 -0.1879  0.07439</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="co"># gpac</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>opt_sarma_4 <span class="ot">=</span> <span class="fu">set.options</span>(<span class="at">var_model =</span> <span class="st">&quot;sarma_HR&quot;</span>, <span class="at">model_order =</span> <span class="st">&quot;gpac&quot;</span>,</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>                          <span class="at">order_max =</span> <span class="fu">list</span>(<span class="at">ar =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="at">ma =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>)))</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>dcs_sarma_4 <span class="ot">=</span> <span class="fu">dcs</span>(y_sarma, opt_sarma_4)</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dcs_sarma_4<span class="sc">$</span>var_est)</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimation of SARMA((2,2),(2,0))</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma:    0.5061 </span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; stationary:   TRUE </span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ar:</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          lag 0    lag 1     lag 2</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 0  1.00000  0.85200  0.291300</span></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 1 -0.46200 -0.14640 -0.051140</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 2  0.01744 -0.02795 -0.009702</span></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ma:</span></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          lag 0</span></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 0  1.00000</span></span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 1 -0.33880</span></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 2 -0.01287</span></span></code></pre></div>
</div>
</div>
<div id="modeling-errors-with-long-memory" class="section level2">
<h2>3.4 Modeling errors with long memory</h2>
<p>This package includes a bandwidth selection algorithm when the errors <span class="math inline">\(\varepsilon(x, t)\)</span> follow an SFARIMA<span class="math inline">\(((p_x, p_t), (q_x, q_t))\)</span> process with long memory. Order selection for SFARIMA models works exactly as in the SARMA case. We use the same SARMA model as in 3.3 with long-memory parameters <span class="math inline">\(d = (0.3, 0.1)\)</span>:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>ar_mat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.12</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>ma_mat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="fl">0.2</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.1</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.1</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>sigma  <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="fl">0.25</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>model_list <span class="ot">=</span> <span class="fu">list</span>(<span class="at">ar =</span> ar_mat, <span class="at">ma =</span> ma_mat, <span class="at">d =</span> d, <span class="at">sigma =</span> sigma)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>sim_sfarima <span class="ot">=</span> <span class="fu">sfarima.sim</span>(<span class="at">n_x =</span> <span class="dv">101</span>, <span class="at">n_t =</span> <span class="dv">101</span>, <span class="at">model =</span> model_list)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co"># SFARIMA surface observations</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>y_sfarima <span class="ot">=</span> y.norm1 <span class="sc">+</span> sim_sfarima<span class="sc">$</span>Y</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co"># surface.dcs(y_sfarima)</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>opt_sfarima <span class="ot">=</span> <span class="fu">set.options</span>(<span class="at">var_model =</span> <span class="st">&quot;sfarima_RSS&quot;</span>)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>dcs_sfarima <span class="ot">=</span> <span class="fu">dcs</span>(y_sfarima, opt_sfarima)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dcs_sfarima<span class="sc">$</span>var_est)</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimation of SFARIMA((1,1),(1,1))</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; d:        0.3146 0.09794 </span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; SD (sigma):   0.4978 </span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; stationary:   TRUE </span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ar:</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         lag 0    lag 1</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 0  1.0000  0.38940</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 1 -0.1575 -0.06132</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ma:</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          lag 0    lag 1</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 0  1.00000 -0.50950</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 1 -0.07279  0.03708</span></span></code></pre></div>
</div>
<div id="estimation-of-derivatives" class="section level2">
<h2>3.5 Estimation of derivatives</h2>
<p>Local polynomial estimation is suitable for estimation of derivatives of a function or a surface. While estimation of derivatives works as well under dependent errors, the example uses the iid. model from 3.2. Derivatives can be computed for any derivative vector <code>drv</code>, if the values are non-negative and an appropriate kernel function is chosen (such that the derivative order of the kernel matches the derivative order in <code>drv</code>). Note that the order of the polynomials for the <span class="math inline">\(\nu\)</span>th derivative is chosen to be <span class="math inline">\(p_i = \nu_i + 1, i = x, t\)</span>. As bandwidths increase with the order of the derivatives, the bandwidth might be large for higher derivative orders.</p>
<p>The estimator for <span class="math inline">\(m^{(1, 0)}(x, t)\)</span> is</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>opt_drv_1 <span class="ot">=</span> <span class="fu">set.options</span>(<span class="at">drv =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="at">kerns =</span> <span class="fu">c</span>(<span class="st">&quot;MW_321&quot;</span>, <span class="st">&quot;MW_220&quot;</span>))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>opt_drv_1<span class="sc">$</span>IPI_options<span class="sc">$</span>trim <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>dcs_drv_1 <span class="ot">=</span> <span class="fu">dcs</span>(y_iid, opt_drv_1)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>dcs_drv_1</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dcs </span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DCS with automatic bandwidth selection:</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Selected Bandwidths:</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      h_x: 0.24868 </span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      h_t: 0.41024 </span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Variance Factor:</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      c_f: 1.002 </span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co"># surface.dcs(dcs_drv_1, trim = c(0.1, 0.1), plot_choice = 2)</span></span></code></pre></div>
<p>The estimator for <span class="math inline">\(m^{(0, 2)}(x, t)\)</span> is given by</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>opt_drv_2 <span class="ot">=</span> <span class="fu">set.options</span>(<span class="at">drv =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">kerns =</span> <span class="fu">c</span>(<span class="st">&quot;MW_220&quot;</span>, <span class="st">&quot;MW_422&quot;</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>opt_drv_2<span class="sc">$</span>IPI_options<span class="sc">$</span>trim <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>dcs_drv_2 <span class="ot">=</span> <span class="fu">dcs</span>(y_iid, opt_drv_2)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>dcs_drv_2</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dcs </span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DCS with automatic bandwidth selection:</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Selected Bandwidths:</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      h_x: 0.28678 </span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      h_t: 0.37157 </span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Variance Factor:</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      c_f: 1.002 </span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="co"># surface.dcs(dcs_drv_2, trim = c(0.1, 0.1), plot_choice = 2)</span></span></code></pre></div>
</div>
</div>
<div id="mathematical-background" class="section level1">
<h1>4 Mathematical Background</h1>
<div id="double-conditional-smoothing" class="section level2">
<h2>4.1 Double Conditional Smoothing</h2>
<p>The double conditional smoothing (DCS, see <span class="citation">Feng (2013)</span>) is a spatial smoothing technique which effectively reduces the two-dimensional estimation to two one-dimensional estimation procedures. The DCS is defined for kernel regression as well as for local polynomial regression.</p>
<p>Classical bivariate (and multivariate) regression has been considered e.g. by <span class="citation">Herrmann <em>et al.</em> (1995)</span> (kernel regression) and <span class="citation">Ruppert and Wand (1994)</span> (local polynomial regression). The DCS provides now a faster and, especially for equidistant data, more efficient smoothing scheme, which leads to reduced computation time. For the DCS procedure implemented in this package, consider a <span class="math inline">\((n_x \times n_t)\)</span>-matrix <span class="math inline">\(\mathbf{Y}\)</span> of non-empty observations <span class="math inline">\(u_{i,j}\)</span> and equidistant covariates <span class="math inline">\(X\)</span>, <span class="math inline">\(T\)</span> on <span class="math inline">\([0,1]\)</span>, where <span class="math inline">\(X\)</span> has length <span class="math inline">\(n_x\)</span> and <span class="math inline">\(T\)</span> has length <span class="math inline">\(n_t\)</span>. The model is then <span class="math display">\[
y_{i,j} = m(x_i, t_j) + \varepsilon_{i,j}
\]</span> where <span class="math inline">\(m(x, t)\)</span> is the mean or trend function, <span class="math inline">\(x_i \in X\)</span>, <span class="math inline">\(t_j \in T\)</span> and <span class="math inline">\(\varepsilon\)</span> is a random error function with zero mean. The model in matrix form is <span class="math inline">\(\mathbf{Y} = \mathbf{M}_1 + \mathbf{E}\)</span> at the observation points.</p>
<p>The main assumption of the DCS is that of product kernels, i.e. the weights in the respective methods are constructed by <span class="math inline">\(K(u,v) = K_1(u) K_2(v)\)</span>. Now, a two stage smoother can be constructed by either the kernel weights directly (kernel regression) or by using locally weighted regression with kernels <span class="math inline">\(K_1\)</span>, <span class="math inline">\(K_2\)</span>, in any case, the weights are called <span class="math inline">\(\mathbf{W}_x\)</span> and <span class="math inline">\(\mathbf{W}_t\)</span>. The DCS procedure implemented in <em>DCSmooth</em> smoothes over rows (conditioning on <span class="math inline">\(X\)</span>) first and then over columns (conditioning on <span class="math inline">\(T\)</span>), although switching the smoothing order is exactly equivalent. Hence, the DCS is given by the following equations: <span class="math display">\[
\begin{align*}
\mathbf{\widehat{M}}_0[ \ , j] &amp;= \mathbf{Y} \cdot \mathbf{W}_t[ \ , j] \\
\mathbf{\widehat{M}}_1[i, \ ] &amp;= \mathbf{W}_x [i, \ ] \cdot \mathbf{\widehat{M}}_0
\end{align*}
\]</span></p>
</div>
<div id="bandwidth-selection" class="section level2">
<h2>4.2 Bandwidth Selection</h2>
<p>The bandwidth vector <span class="math inline">\(h = (h_x, h_t)\)</span> is selected via an iterative plug-in (IPI) algorithm <span class="citation">(Gasser <em>et al.</em>, 1991)</span>. The IPI selects the optimal bandwidths by minimizing the mean integrated squared error (MISE) of the estimator. As the MISE includes derivatives of the regression surface <span class="math inline">\(m(x, t)\)</span>, auxiliary bandwidths for estimation of these derivatives are calculated via an inflation method. These inflation method connects the bandwidths of <span class="math inline">\(m(x, t)\)</span> with that of a derivative <span class="math inline">\(m^{(\nu_x, \nu_t)}(x, t)\)</span> by <span class="math display">\[
\widetilde{h}_k = c_k \cdot h_k^{\alpha}, \quad k = x, t
\]</span> and is called exponential inflation method (EIM). The values of <span class="math inline">\(c_k\)</span> are chosen on simulations, that of <span class="math inline">\(alpha\)</span> are subject to the derivative of interest. The IPI now starts with an initial bandwidth <span class="math inline">\(h_0\)</span> (chosen to be <span class="math inline">\(h_0 = (0.1, 0.1)\)</span>) and calculates in each step <span class="math inline">\(s\)</span> the auxiliary bandwidths <span class="math inline">\(\widetilde{h}_{k,s}\)</span> from <span class="math inline">\(h_{s-1}\)</span> and <span class="math inline">\(h_s\)</span> from the smoothed derivative surfaces using <span class="math inline">\(\widetilde{h}_{k,s}\)</span>. The iteration process finishes until a certain threshold is reached.</p>
</div>
<div id="boundary-modification" class="section level2">
<h2>4.3 Boundary Modification</h2>
<p>In kernel regression, the boundary problem exists, which leads to biased estimated at the boundaries of the regression surface. This problem can (partially) be solved by means of suitable boundary kernels as introduced by <span class="citation">Müller (1991)</span> and <span class="citation">Müller and Wang (1994)</span>. These boundary kernels differ in their degrees of smoothness and hence lead to different estimation results at the boundaries. However, all kernels are similar to the classical kernels in the interior region of the regression.</p>
<p>Following <span class="citation">Feng and Schäfer (2021)</span>, a boundary modification is also defined for local polynomial regression. In the <em>DCSmooth</em> package, the local polynomial regression is always with boundary modification weights. Kernel types available (either for kernel regression or local polynomial regression) are Müller-type, Müller-Wang-type and truncated kernels, denoted by <code>M</code>, <code>MW</code> and <code>T</code>. In most applications, the Müller-Wang type are the preferred weighting functions.</p>
<p>For observations <span class="math inline">\(X = x_i\)</span>, <span class="math inline">\(x_i, i = 1, \dots, n_x\)</span> and a given bandwidth <span class="math inline">\(h\)</span>, define <span class="math inline">\(u_r = \frac{x_r - X}{h} \in [-1, q]\)</span>. A (left) boundary kernel function <span class="math inline">\(K^l_q(u)\)</span> of order <span class="math inline">\((k, \mu, \nu)\)</span> is defined on <span class="math inline">\([-1, q]\)</span>, for <span class="math inline">\(q \in [0,1]\)</span> and has the following properties <span class="math display">\[
\int_{-1}^q u^j K^l_q(u) \text{d} u = \begin{cases}
0 &amp; \text{ for } 0 \leq j &lt; k, j \neq \nu\\
(-1)^\nu \nu! &amp; \text{ for } j = \nu\\
\beta \neq 0 &amp; \text{ for } j = k
\end{cases}
\]</span> The corresponding right boundary kernels can be calculated by <span class="math inline">\(K^r_q(u) = (-1)\nu K_q(-u)\)</span>. The boundary kernels assigned by <code>kernel.assign()</code> are left boundary kernels.</p>
</div>
<div id="spatial-arma-processes" class="section level2">
<h2>4.4 Spatial ARMA processes</h2>
<p>The SARMA process <span class="math inline">\(\varepsilon_{i,j}\)</span> is given by the following equations: <span class="math display">\[
\phi(B_1, B_2)\varepsilon_{i,j} = \psi(B_1, B_2)\eta_{i,j},\\
\]</span> where the lag operators are <span class="math inline">\(B_1 \varepsilon_{i,j} = \varepsilon_{i-1, j}\)</span> and <span class="math inline">\(B_2 \varepsilon_{i,j} = \varepsilon_{i,j-1}\)</span>, <span class="math inline">\(\xi \underset{iid.}{\sim} \mathcal{N}(0,\sigma^2)\)</span> and <span class="math display">\[
\phi(z_1, z_2) = \sum_{m = 0}^{p_1} \sum_{n = 0}^{p_2} \phi_{m, n} z_1^m z_2^n, \ \psi(z_1, z_2) = \sum_{m = 0}^{q_1} \sum_{n = 0}^{q_2} \psi_{m, n} z_1^m z_2^n.
\]</span> The coefficients <span class="math inline">\(\psi_{m,n}\)</span> and <span class="math inline">\(\phi_{m,n}\)</span> are written in matrix form <span class="math display">\[
\begin{align*}
\boldsymbol{\phi} = \begin{pmatrix}
\phi_{0,0} &amp; \dots &amp; \phi_{0, p_2} \\
\vdots &amp; \ddots &amp; \\
\phi_{p_1, 0} &amp;  &amp; \phi_{p_1, p_2}
\end{pmatrix} \ \text{ and } \ \boldsymbol{\psi} = \begin{pmatrix}
\psi_{0, 0} &amp; \dots &amp; \psi_{0, q_2} \\
\vdots &amp; \ddots &amp; \\
\psi_{q_1, 0} &amp;  &amp; \psi_{q_1, q_2}
\end{pmatrix},
\end{align*}
\]</span> where <span class="math inline">\(\Phi\)</span> is the AR-part (<code>$var_model$ar</code>) and <span class="math inline">\(\Psi\)</span> is the MA-part (<code>$var_model$ma</code>). The example from 3.3, <span class="math display">\[
\begin{align}
\boldsymbol{\phi} = \begin{pmatrix} 1 &amp; 0.4 \\ -0.3 &amp; -0.12 \end{pmatrix}
\ \text{ and } \
\boldsymbol{\psi} = \begin{pmatrix} 1 &amp; -0.2 \\ -0.5 &amp; 0.1 \end{pmatrix}
\end{align},
\]</span> would then reduce to the process <span class="math display">\[
\varepsilon_{i,j} = 0.4\varepsilon_{i,j-1} - 0.3 \varepsilon_{i-,j} + 0.2\varepsilon_{i-1,j-1} + 0.2 \xi_{i,j-1} + 0.2 \xi_{i-1,j} -0.5 \xi_{i-1,j-1} + \xi_{i,j}.
\]</span> Note that this process can be written as product of two univariate processes in the sense that <span class="math display">\[
\phi_1(B_1)\phi_2(B_2)^T \varepsilon_{i,j} = \psi_1(B_1) \psi_2(B_2)^T \eta_{i,j},\\
\]</span> with <span class="math display">\[
\phi_1 = \begin{pmatrix} 1 \\ -0.3 \end{pmatrix}, \quad \phi_2 = \begin{pmatrix} 1 \\ 0.4 \end{pmatrix}, \quad \psi_1 = \begin{pmatrix} 1 \\ -0.5 \end{pmatrix}, \quad \psi_2 = \begin{pmatrix} 1 \\ -0.2 \end{pmatrix}.
\]</span> Hence, these process forms a separable SARMA. Estimation of separable SARMA models can be reduced to estimation of univariate ARMA models.</p>
</div>
<div id="estimation-of-sarma-processes" class="section level2">
<h2>4.5 Estimation of SARMA processes</h2>
<p>For estimation of SARMA models, three methods are implemented in <em>DCSmooth</em>:</p>
<div id="estimation-of-a-separable-sarma-by-ml-estimation" class="section level3 unnumbered">
<h3 class="unnumbered">Estimation of a separable SARMA by ML-estimation</h3>
<p>This method is only available under the assumption of a separable model. Define two univariate time series <span class="math display">\[
\varepsilon_{1,r} = \{\varepsilon_1\}_r = \{\varepsilon_{i,j}\}_{i + n_t (j - 1)}, \quad \varepsilon_{2,s} = \{\varepsilon_2\}_s = \{\varepsilon_{i,j}\}_{j + n_x * (i - 1)}
\]</span> for <span class="math inline">\(r,s = 1, \dots, n_x \cdot n_t\)</span>, <span class="math inline">\(i = 1, \dots, n_x\)</span>, <span class="math inline">\(j = 1, \dots, n_t\)</span>. The parameters <span class="math inline">\(\phi_1, \psi_1\)</span> of <span class="math inline">\(\varepsilon_{1,r}\)</span> and <span class="math inline">\(\phi_2, \psi_2\)</span> of <span class="math inline">\(\varepsilon_{2,s}\)</span> can then be estimated by well-known maximum likelihood estimators.</p>
</div>
<div id="least-squares-estimation-using-the-rss" class="section level3 unnumbered">
<h3 class="unnumbered">Least squares estimation using the RSS</h3>
<p>The SARMA model can be rewritten as <span class="math display">\[
\eta_{i,j} = \psi(B_1, B_2)^{-1}\phi(B_1, B_2)\varepsilon_{i,j},\\
\]</span> which allows for an <span class="math inline">\(AR(\infty)\)</span>-representation of the SARMA model <span class="math display">\[
\eta_{i,j} = \sum_{r,s = 0}^{\infty} \theta^{AR}_{r,s} \varepsilon_{i-r, s-j}
\]</span></p>
<p>From this, we can define the residual sum of squares (RSS) and get an estimate for the vector of coefficients <span class="math inline">\(\theta = c(\phi_{1,0}, \phi_{0,1}, \dots, \psi_{1,0}, \psi_{0,1}, \dots\)</span> by <span class="math display">\[
\widehat{\theta} = \arg \min RSS \approx \arg \min \sum_{i,j = 0}^{\infty} \eta_{i,j}^2
\]</span></p>
<p>Calculation of the $AR() representation of an SARMA model is difficult for a general SARMA but for a separable SARMA, the known univariate formulas hold.</p>
<p>These procedure can be directly used for SFARIMA models, if the long memory parameter <span class="math inline">\(d\)</span> is included in <span class="math inline">\(\theta\)</span> (see <span class="citation">Beran <em>et al.</em> (2009)</span>).</p>
</div>
<div id="the-hannan-rissanen-algorithm" class="section level3">
<h3>The Hannan-Rissanen Algorithm</h3>
<p>The previously defined estimation methods require numeric optimization of some quantities and hence take more time for calculation on a computer. The Hannan-Rissanen algorithm (<span class="citation">Hannan and Rissanen (1982)</span>) provides a much faster estimation procedure. An extension to SARMA models is straightforward:</p>
<p>The main idea Hannan-Rissanen algorithm is to use a high-order SAR auxiliary model for initial estimation of the non observable innovations sequence. Then, a linear regression model is applied, which yields the SARMA-parameters from the observations and estimated innovations.</p>
<p>Let <span class="math inline">\(\{\varepsilon\}_{i,j}\)</span> be the the ordered observations of the <span class="math inline">\(SARMA((p_x, p_t), (q_x, q_t))\)</span> process <span class="math inline">\(\varepsilon(x, t)\)</span> with <span class="math inline">\(i = 1, \dots, n_x, j = 1, \dots, n_t\)</span>. The SARMA parameters <span class="math inline">\(\mathbf{\phi, \mathbf{\psi}\)</span> are then estimated by the modified Hannan-Rissanen algorithm: 1. Obtain the auxiliary residuals <span class="math inline">\(\widetilde{\eta}_{i,j}\)</span> by fitting a high-order autoregressive model with <span class="math inline">\((\widetilde{p}_x, \widetilde{p}_t) \geq (p_x, p_t)\)</span> to the observations: <span class="math display">\[
\begin{align}
\widetilde{\eta}_{i,j} = \begin{cases}
\sum_{m = 0}^{\widetilde{p}_1} \sum_{n = 0}^{\widetilde{p}_2} \widetilde{\phi}_{m,n} \varepsilon_{i - m, j - n}, &amp; \widetilde{p}_1 &lt; i \leq n_1, \widetilde{p}_2 &lt; j \leq n_2\\
0, &amp;1 \leq i \leq \widetilde{p}_1, 1 \leq j \leq \widetilde{p}_2
\end{cases}
\end{align}
\]</span> where <span class="math inline">\(\widetilde{\phi}_{m,n}\)</span> is estimated by the Yule-Walker equations and <span class="math inline">\(\phi_{0,0} = 1\)</span>. 2. Obtain <span class="math inline">\(\widehat{\phi}_{m,n}\)</span> and <span class="math inline">\(\widehat{\psi}_{m,n}\)</span> and the estimated innovations <span class="math inline">\(\widehat{\eta}_{i,j}\)</span> by linear regression from <span class="math display">\[
\begin{align}
\varepsilon_{i,j} = -\sum_{\substack{m=0\\m \neq n = 0}}^{p_1} \sum_{\substack{n=0\\n \neq m = 0}}^{p_2} \widehat{\phi}_{m,n} \varepsilon_{i-m,j-n} + \sum_{\substack{m=0\\m \neq n = 0}}^{q_1} \sum_{\substack{n=0\\n \neq m = 0}}^{q_2} \widehat{\psi}_{m,n} \widetilde{\xi}_{i-m,j-n} + \widehat{\xi}_{i,j}
\end{align}
\]</span> The resulting coefficients <span class="math inline">\(\widehat{\mathbf{\phi}}\)</span>, <span class="math inline">\(\widehat{\mathbf{\psi}}\)</span> are then the estimates for the parameters.</p>
<p>The autocovariance function of the SARMA-process is <span class="math inline">\(\gamma(s,t) = \mathbb{E}(\varepsilon_{i,j} \varepsilon_{i+s, j+t})\)</span>. For <span class="math inline">\(\widetilde{p}_x, \widetilde{p}_t\)</span>, the spatial Yule-Walker equation for the <span class="math inline">\(SAR(\widetilde{p}_x, \widetilde{p}_t)\)</span> approximation of the SARMA is then <span class="math display">\[
\begin{align}
\mathbf{\Gamma} \ \left( \text{vec} (\widetilde{\boldsymbol{\phi}}) \setminus \{ \widetilde{\phi}_{0,0}\} \right) = \gamma
\end{align}
\]</span> where <span class="math inline">\(\mathbf{\Gamma}\)</span> is the autocovariance matrix and <span class="math inline">\(\gamma\)</span> the vector of autocovariances when using the following notation: <span class="math display">\[
\begin{align}
\mathbf{\Gamma} &amp;= \begin{pmatrix}
\gamma(0,0) &amp; \gamma(1,0) &amp; \dots   &amp; \gamma(\widetilde{p}_1,0) &amp; \gamma(2,0) &amp; \dots   &amp; \gamma(\widetilde{p}_1 - 1, \widetilde{p}_2)\\
\gamma(1,0) &amp; \gamma(0,0) &amp;         &amp;                           &amp;             &amp;         &amp; \gamma(\widetilde{p}_1 - 2, \widetilde{p}_2)\\
\vdots      &amp;             &amp; \ddots  &amp;                           &amp;             &amp;         &amp; \vdots \\
\gamma(\widetilde{p}_1 - 1, \widetilde{p}_2) &amp; &amp; \dots &amp;            &amp;             &amp;         &amp; \gamma(0,0)
\end{pmatrix} \\
\gamma &amp;= \left(\gamma(0,1), \gamma(0,2), \dots, \gamma(\widetilde{p}_1, 0), \dots, \gamma(\widetilde{p}_1, \widetilde{p}_2) \right)^T.
\end{align}
\]</span></p>
</div>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Beran2009" class="csl-entry">
Beran, J., Ghosh, S. and Schell, D. (2009) On least squares estimation for long-memory lattice processes. <em>Journal of Multivariate Analysis</em>, <strong>100</strong>, 2178–2194.
</div>
<div id="ref-Feng2013" class="csl-entry">
Feng, Y. (2013) Double-conditional smoothing of high-frequency volatility surface in a spatial multiplicative component GARCH with random effects. <em>Center for International Economics Working Paper</em>, <strong>415</strong>, 643–652.
</div>
<div id="ref-FengSchaefer2021" class="csl-entry">
Feng, Y. and Schäfer, B. (2021) Boundary modification in local polynomial regression and associated boundary kernel functions. <em>Preprint, Paderborn University</em>.
</div>
<div id="ref-Gasser1991" class="csl-entry">
Gasser, T., Kneip, A. and Köhler, W. (1991) A flexible and fast method for automatic smoothing. <em>Journal of the American Statistical Association</em>, <strong>86</strong>, 643–652.
</div>
<div id="ref-HannanRissanen1982" class="csl-entry">
Hannan, E. J. and Rissanen, J. (1982) Recursive estimation of mixed autoregressive-moving average order. <em>Biometrika</em>, <strong>69</strong>, 81–94.
</div>
<div id="ref-Herrmann1995" class="csl-entry">
Herrmann, E., Engel, J., Gasser, T., et al. (1995) A bandwidth selector for bivariate kernel regression. <em>Journal of the Royal Statistical Society</em>, <strong>57</strong>, 171–180.
</div>
<div id="ref-Mueller1991" class="csl-entry">
Müller, H.-G. (1991) Smooth optimum kernel estimators near endpoints. <em>Biometrika</em>, <strong>78</strong>, 521–530.
</div>
<div id="ref-MuellerWang1994" class="csl-entry">
Müller, H.-G. and Wang, J.-L. (1994) Hazard rate estimation under random censoring with varying kernels and bandwidths. <em>Biometrics</em>, <strong>50</strong>, 61–76.
</div>
<div id="ref-RuppertWand1994" class="csl-entry">
Ruppert, D. and Wand, M. P. (1994) Multivariate locally weighted least squares regression. <em>The Annals of Statistics</em>, <strong>22</strong>, 1346–1370.
</div>
<div id="ref-SchaeferFeng2020" class="csl-entry">
Schäfer, B. and Feng, Y. (2021) Fast computation and bandwidth selection algorithms for smoothing functional time series. <em>Preprint, Paderborn University</em>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
