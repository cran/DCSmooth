<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Bastian Schaefer" />


<title>DCSmooth</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">DCSmooth</h1>
<h4 class="author">Bastian Schaefer</h4>
<h4 class="date">06.07.2021</h4>


<div id="TOC">
<ul>
<li><a href="#introduction">1 Introduction</a></li>
<li><a href="#details-of-functions">2 Details of Functions</a>
<ul>
<li><a href="#functions">2.1 Functions</a>
<ul>
<li><a href="#set.options"><code>set.options</code></a></li>
<li><a href="#dcs"><code>dcs</code></a></li>
<li><a href="#surface.dcs"><code>surface.dcs</code></a></li>
<li><a href="#qarma.sim"><code>qarma.sim</code></a></li>
<li><a href="#qarma.est"><code>qarma.est</code></a></li>
<li><a href="#sfarima.sim"><code>sfarima.sim</code></a></li>
<li><a href="#sfarima.est"><code>sfarima.est</code></a></li>
</ul></li>
<li><a href="#methods">2.2 Methods</a></li>
<li><a href="#data">2.3 Data</a></li>
</ul></li>
<li><a href="#application">3 Application</a>
<ul>
<li><a href="#application-of-the-dcs-with-iid.-errors">3.1 Application of the DCS with iid. errors</a></li>
<li><a href="#application-of-the-dcs-with-qarma-errors">3.2 Application of the DCS with QARMA errors</a></li>
<li><a href="#modelling-errors-with-long-memory">3.3 Modelling errors with long memory</a></li>
</ul></li>
<li><a href="#mathematical-background">4 Mathematical Background</a>
<ul>
<li><a href="#double-conditional-smoothing">4.1 Double Conditional Smoothing</a></li>
<li><a href="#bandwidth-selection">4.2 Bandwidth Selection</a></li>
<li><a href="#boundary-modification">4.3 Boundary Modification</a></li>
<li><a href="#spatial-arma-estimation">4.4 Spatial ARMA estimation</a></li>
</ul></li>
<li><a href="#appendix">Appendix</a>
<ul>
<li><a href="#a.1-kernels-available-in-the-dcsmooth-package">A.1 Kernels available in the <em>DCSmooth</em> package:</a></li>
</ul></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<div id="introduction" class="section level1">
<h1>1 Introduction</h1>
<p>This vignette describes the use of the <em>DCSmooth</em>-package and its functions <code>dcs</code>, <code>set.options</code>, <code>surface.3d</code>, <code>qarma.est</code> and <code>qarma.sim</code>. This package provides some tools for nonparametric estimation of the mean surface <span class="math inline">\(m\)</span> of an observed sample of some function <span class="math display">\[y(x, t) = m(x, t) + \varepsilon(x, t).\]</span> This package is accompanying <span class="citation">Schäfer and Feng (2021)</span>. Boundary modification procedures for local polynomial smoothing are considered by <span class="citation">Feng and Schäfer (2021)</span>. For a more comprehensive and detailed description of the algorithms than in section 4, please refer to these papers.</p>
<p>The <em>DCSmooth</em> contains the following functions, methods and data sets:</p>
<table>
<colgroup>
<col width="25%" />
<col width="74%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"><span style="display: inline-block; width:170px">Functions</span></th>
<th align="left"><span style="display: inline-block; width:500px"> </span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>set.options()</code></td>
<td align="left">Define options for the <code>dcs()</code>-function.</td>
</tr>
<tr class="even">
<td align="left"><code>dcs()</code></td>
<td align="left">Nonparametric estimation of the expectation function of a matrix <code>Y</code>. Includes automatic iterative plug-in bandwidth selection.</td>
</tr>
<tr class="odd">
<td align="left"><code>surface.dcs()</code></td>
<td align="left">Plot for the surface from an <code>&quot;dcs&quot;</code>-object.</td>
</tr>
<tr class="even">
<td align="left"><code>qarma.sim()</code></td>
<td align="left">Simulate a QARMA-model.</td>
</tr>
<tr class="odd">
<td align="left"><code>qarma.est()</code></td>
<td align="left">Estimate the parameters of a QARMA-model.</td>
</tr>
<tr class="even">
<td align="left"><code>sfarima.sim()</code></td>
<td align="left">Simulate a SFARIMA-model.</td>
</tr>
<tr class="odd">
<td align="left"><code>sfarima.est()</code></td>
<td align="left">Estimate the parameters of a SFARIMA-model.</td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col width="25%" />
<col width="74%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"><span style="display: inline-block; width:170px">Methods/Generics</span></th>
<th align="left"><span style="display: inline-block; width:500px"> </span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>summary.dcs()</code></td>
<td align="left">Summary statistics for an object of class <code>&quot;dcs&quot;</code>.</td>
</tr>
<tr class="even">
<td align="left"><code>print.dcs()</code></td>
<td align="left">Print an object of class <code>&quot;dcs&quot;</code>.</td>
</tr>
<tr class="odd">
<td align="left"><code>plot.dcs()</code></td>
<td align="left">Plot method for an <code>&quot;dcs&quot;</code>-object, returns contour plot.</td>
</tr>
<tr class="even">
<td align="left"><code>residuals.dcs()</code></td>
<td align="left">Returns the residuals of the regression from an <code>&quot;dcs&quot;</code>-object.</td>
</tr>
<tr class="odd">
<td align="left"><code>print.summary_dcs()</code></td>
<td align="left">Print an object of class <code>&quot;summary_dcs&quot;</code>, which inherits from <code>summary.dcs()</code>.</td>
</tr>
<tr class="even">
<td align="left"><code>print.set_options()</code></td>
<td align="left">Prints an object of class <code>&quot;dcs_options&quot;</code>, which inherits from <code>set.options()</code></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th align="left"><span style="display: inline-block; width:170px">Data</span></th>
<th align="left"><span style="display: inline-block; width:510px"> </span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>y.norm1</code></td>
<td align="left">A surface with a single gaussian peak.</td>
</tr>
<tr class="even">
<td align="left"><code>y.norm2</code></td>
<td align="left">A surface with two gaussian peaks.</td>
</tr>
<tr class="odd">
<td align="left"><code>y.norm3</code></td>
<td align="left">A surface with two gaussian ridges.</td>
</tr>
</tbody>
</table>
</div>
<div id="details-of-functions" class="section level1">
<h1>2 Details of Functions</h1>
<div id="functions" class="section level2">
<h2>2.1 Functions</h2>
<div id="set.options" class="section level3 unnumbered">
<h3 class="unnumbered"><code>set.options</code></h3>
<p>This auxiliary function simplifies the settings of the <code>dcs</code> function. An object of class <code>dcs_options</code> is created and should be used as <code>dcs_options</code>-argument in the <code>dcs</code> function.</p>
<p>Arguments of <code>set.options</code> are</p>
<ul>
<li><strong>type</strong> Specifies the regression type. Supported methods are kernel regression (<code>&quot;KR&quot;</code>) and local polynomial regression (<code>&quot;LP&quot;</code>), which is the default value.</li>
<li><strong>kerns</strong> A character vector of length 2 stating the identifiers for the kernels in each dimension to use. The first element corresponds to the smoothing conditional on rows, the second conditional on columns. The identifiers are of the form <span class="math inline">\(X\_k\mu\nu\)</span>, where <span class="math inline">\(X\)</span> indicates the smoothing method to use, either one of <code>M</code>, <code>MW</code> or <code>T</code>. The value <span class="math inline">\(k\)</span> is the kernel order, <span class="math inline">\(\mu\)</span> is the smoothness degree and <span class="math inline">\(\nu\)</span> the derivative estimated by the kernel. For more information on the kernels see section 4.3, a list of available kernels is given in A.1. The default kernels are <code>&quot;MW_220</code> for both dimensions.</li>
<li><strong>drv</strong> Derivative <span class="math inline">\((\nu_x, \nu_t)\)</span> of <span class="math inline">\(m(x,t)\)</span> to be estimated. Note that <span class="math inline">\(k \geq \nu + 2\)</span>, hence, only the regression surface (<span class="math inline">\(\nu = 0\)</span> as default value) and the first and second derivatives can be estimated from the currently available kernels.</li>
<li><strong>var_est</strong> Specifies the model assumption for the errors/innovations <span class="math inline">\(\varepsilon(x, t)\)</span> in the regression model. Currently available are <code>iid</code> (independently identically distributed, set as default), <code>qarma</code> (spatial ARMA process) and <code>lm</code> (spatial FARIMA process with long memory). Methods for automated order selection are available for the QARMA estimation via <code>qarma_gpac</code> or <code>qarma_bic</code>. For further information see section 4.4.</li>
<li><strong>IPI_options</strong> Advanced options for tuning the parameters of the iterative plug-in algorithm of the bandwidth selection. These options include 2-element vectors for the inflation parameters (<code>infl_par</code>), the inflation exponents (<code>infl_exp</code>) and a boundary shrinking parameter for stabilized estimation of the necessary derivatives (<code>delta</code>). Another option to further stabilize estimation of derivatives at the boundaries is the use of a constant estimation window at the boundaries setting the boolean variable <code>const_window</code> to <code>TRUE</code>. The default values for the IPI-options depend partly on the regression type selected and are given below.</li>
</ul>
<p><code>set.options</code> returns an object of class <code>&quot;dcs_options</code> including the following values</p>
<ul>
<li><strong>type</strong> Inherited from input.</li>
<li><strong>kerns</strong> Inherited from input.</li>
<li><strong>drv</strong> Inherited from input.</li>
<li><strong>p_order</strong> A numeric vector of length 2, computed from <code>drv</code>. It is <span class="math inline">\(p_k = \nu_k + 1, k = x, t\)</span>.</li>
<li><strong>var_est</strong> Inherited from input.</li>
<li><strong>IPI_options</strong> Options for the iterative-plug in algorithm for bandwidth selection. If unchanged, values are set conditional on <code>type</code> (see default values for <code>KR</code> and <code>LP</code> below).</li>
</ul>
<blockquote>
<p>Every argument of the <code>set.options</code> function has a default value. Hence, a just using <code>set.options()</code> will produce a complete set of options for double conditional smoothing regression in <code>dcs</code> (which is also implemented as default options in <code>dcs</code>, if the argument <code>dcs_options</code> is omitted).</p>
</blockquote>
<p>Default options for kernel regression (<code>type = &quot;KR&quot;</code>) are</p>
<pre><code>#&gt; dcs_options 
#&gt; --------------------------------------- 
#&gt; options for DCS   rows    cols 
#&gt; --------------------------------------- 
#&gt; type: kernel regression 
#&gt; kernels used:        MW_220  MW_220
#&gt; derivative:      0   0
#&gt; variance model:  iid
#&gt; ---------------------------------------
#&gt; IPI options:
#&gt; inflation parameters     2   1
#&gt; inflation exponents  0.5 0.5
#&gt; delta            0.05    0.05
#&gt; constant window width    FALSE
#&gt; ---------------------------------------</code></pre>
<p>Default options for local polynomial regression (<code>type = &quot;LP&quot;</code>) are</p>
<pre><code>#&gt; dcs_options 
#&gt; --------------------------------------- 
#&gt; options for DCS   rows    cols 
#&gt; --------------------------------------- 
#&gt; type: kernel regression 
#&gt; kernels used:        MW_220  MW_220
#&gt; derivative:      0   0
#&gt; variance model:  iid
#&gt; ---------------------------------------
#&gt; IPI options:
#&gt; inflation parameters     2   1
#&gt; inflation exponents  0.5 0.5
#&gt; delta            0.05    0.05
#&gt; constant window width    FALSE
#&gt; ---------------------------------------</code></pre>
</div>
<div id="dcs" class="section level3 unnumbered">
<h3 class="unnumbered"><code>dcs</code></h3>
<p>The <code>dcs</code>-function serves as main function of the package and includes IPI-bandwidth selection and non-parametric smoothing using the selected bandwidths. This function creates an object of class <code>dcs</code>, which includes the results of the DCS procedure.</p>
<p>Arguments of <code>dcs</code> are</p>
<ul>
<li><strong>Y</strong> The matrix of observations to be smoothed via the DCS procedure. This matrix should only contain numeric values and no missing observations. For computational reasons, <code>Y</code> has to have at least three rows and columns, however, for reliable results the size should be larger.</li>
<li><strong>dcs_options</strong> The options used for the smoothing and bandwidth selection. This should be an object of class <code>dcs_options</code> created by <code>set.options</code>. This argument is optional, if omitted, all options will be set to their default values from the <code>set.options</code> function.</li>
<li><strong>h</strong> Either a two-value vector of bandwidths or <code>&quot;auto&quot;</code> if bandwidth selection should be employed (the default).</li>
<li><strong>…</strong> Further arguments to be passed to the function. This includes the covariates <code>X</code> and <code>T</code> which should be ordered numerical vectors whose length matches the number of rows of <code>Y</code> for <code>X</code> and the number of columns of <code>Y</code> for <code>T</code>. If <code>var_est = &quot;qarma&quot;</code>, additional arguments can be set to determine the order of the <span class="math inline">\(QARMA((p_1, p_2), (q_1, q_2))\)</span> with <code>qarma_order = list(ar = c(1, 1), ma = c(1, 1))</code>. If a order selection procedure is used, the maximum order can be set with <code>order_max = list(ar = c(1, 1), ma = c(1, 1))</code>. Common sense applies when selection these parameters, they should be nonzero integers. Too large orders might lead to (heavily) increased computation time.</li>
</ul>
<p><code>dcs</code> returns an object of class <code>&quot;dcs</code> including the following values</p>
<ul>
<li><strong>X, T</strong> Vectors of covariates inherited from input.</li>
<li><strong>Y</strong> Matrix of observations inherited from input.</li>
<li><strong>M</strong> Matrix of smoothed values. If the argument <code>h = &quot;auto</code> is used in <code>dcs</code>, the bandwidths are optimised via the IPI-algorithm, if <code>h</code> is set to fixed values, these bandwidth are used.</li>
<li><strong>R</strong> Matrix of residuals computed from <span class="math inline">\(R = Y - M\)</span>.</li>
<li><strong>h</strong> Bandwidth used for smoothing of <code>Y</code>. Either obtained by IPI or given as argument in <code>dcs</code>.</li>
<li><strong>c_f</strong> The estimated variance factor used in the last iteration of the bandwidth selection algorithm. Is set to <code>NA</code>’, if no bandwidth selection is used.</li>
<li><strong>var_model</strong> The model obtained for the innovations <span class="math inline">\(\varepsilon(x, t)\)</span>. Output depends on the model specification used in <code>dcs_options$var_est</code>. For <code>&quot;iid</code> is contains the estimated standard deviation of the residuals and an indicator for stationarity, which is true by assumptions. For <code>&quot;qarma&quot;</code>, <code>&quot;qarma_gpac</code> and <code>&quot;qarma_bic&quot;</code> it contains the estimated coefficient matrices <code>$ar</code> and <code>$ma</code>, the standard deviation <code>$sigma</code> as well as an stationarity indicator <code>$stnry</code>. For <code>lm</code> the output is similar to that of QARMA with the addition of the estimated long memory parameter vector <code>d</code>. Is set to <code>NA</code>’, if no bandwidth selection is used.</li>
<li><strong>dcs_options</strong> An <code>dcs_options</code> object containing the options used in the function.</li>
<li><strong>iterations</strong> An integer reporting the number of iterations of the IPI algorithm. Is set to <code>NA</code>’, if no bandwidth selection is used.</li>
<li><strong>time_used</strong> A number reporting the time (in seconds) used for the IPI algorithm (total including all iterations). Is set to <code>NA</code>’, if no bandwidth selection is used.</li>
</ul>
</div>
<div id="surface.dcs" class="section level3 unnumbered">
<h3 class="unnumbered"><code>surface.dcs</code></h3>
<p>This function is a convenient wrapper for the <code>plotly::plot_ly</code> function of the <em>plotly</em> package, for easy display of the considered surfaces. Direct plotting is available for any object of class <code>&quot;dcs&quot;</code> or any numeric matrix.</p>
<p>Arguments of <code>surface.dcs</code> are</p>
<ul>
<li><strong>Y</strong> Either an object of class <code>&quot;dcs&quot;</code>, inheriting from a call to <code>dcs</code> or a numeric matrix, which is then directly passed to <code>plotly::plot_ly</code>.</li>
<li><strong>plot_choice</strong> Only used, if <code>&quot;Y&quot;</code> is an object of class <code>&quot;dcs&quot;</code>. Specifies the surface to be plotted, <code>1</code> for the original observations, <code>2</code> for the smoothed surface and <code>3</code> for the residual surface. If <code>plot_choice</code> is omitted and <code>Y</code> is an <code>dcs</code>-object, a choice dialogue will be prompted to the console, with the same options.</li>
<li><strong>…</strong> Further arguments to be passed to the <code>plotly::plot_ly</code> function.</li>
</ul>
<p><code>surface.dcs</code> returns an object of class <code>&quot;plotly&quot;</code>.</p>
</div>
<div id="qarma.sim" class="section level3 unnumbered">
<h3 class="unnumbered"><code>qarma.sim</code></h3>
<p>Simulation of a top-left dependent spatial ARMA process (QARMA). This function returns an object of class <code>qarma</code> with attribute <code>&quot;subclass&quot; = &quot;sim&quot;</code>. The simulated innovations are created from a normal distribution with specified variance <span class="math inline">\(\sigma^2\)</span>. This function uses a burn-in period for more consistent results.</p>
<p>Arguments of <code>qarma.sim</code> are</p>
<ul>
<li><strong>n_x</strong>, <strong>n_t</strong> The dimension of the resulting matrix of observations, where <code>n_x</code> specifies the number of rows and <code>n_t</code> the number of columns. Initially, a matrix of <span class="math inline">\(2 n_x \times 2 n_t\)</span> is simulated, of which simulation points with <span class="math inline">\(i \leq n_x\)</span> or <span class="math inline">\(j \leq n_t\)</span> are discarded (burn-in period).</li>
<li><strong>model</strong> A list containing the model parameters to be used in the simulation of the form <code>list(ar, ma, sigma)</code>. The values <code>ar</code> and <code>ma</code> are matrices of size <span class="math inline">\((p_x + 1) \times (p_t + 1)\)</span> respective <span class="math inline">\((q_x + 1) \times (q_t + 1)\)</span> and containing the coefficients in ascending lag order, so that the upper left entry is equal to 1 (for lag 0 in both dimensions). See the examples in the application part 3.2. The standard deviation of the iid. innovations with zero mean is <code>sigma</code>, which should be a single positive number.</li>
</ul>
<p><code>qarma.sim</code> returns an object of class <code>qarma</code> with attribute <code>&quot;subclass&quot; = &quot;sim&quot;</code> including the following values:</p>
<ul>
<li><strong>Y</strong> The matrix of simulated values with size <span class="math inline">\(n_x \times n_t\)</span> (determined by function arguments <code>n_x</code>, <code>n_t</code>). The matrix <span class="math inline">\(Y\)</span> is the lower left <span class="math inline">\(n_x \times n_t\)</span> submatrix of the actually simulated matrix <span class="math inline">\(Y&#39;\)</span> of size <span class="math inline">\(2 n_x \times 2 n_t\)</span> to avoid effects from setting the initial values (“burn-in period”).</li>
<li><strong>innov</strong> The <span class="math inline">\(n_x \times n_t\)</span> matrix of iid. normally distributed innovations/errors of the QARMA model with zero mean and variance <span class="math inline">\(\sigma^2\)</span> (determined by the function argument <code>model\$sigma</code>). As with <code>Y</code>, the original matrix has size <span class="math inline">\(2 n_x \times 2 n_t\)</span>.</li>
<li><strong>model</strong> The model used for simulation, inherited from input.</li>
<li><strong>stnry</strong> Indicator variable (boolean) for stationarity of the process.</li>
</ul>
</div>
<div id="qarma.est" class="section level3 unnumbered">
<h3 class="unnumbered"><code>qarma.est</code></h3>
<p>Estimation of a top-left dependent spatial ARMA process (QARMA). This function use a variant of the Hannan-Rissanen algorithm for estimation of the coefficient matrices of a QARMA process of a given order. It returns an object of class <code>qarma</code> with attribute <code>&quot;subclass&quot; = &quot;est&quot;</code>.</p>
<p>Arguments of <code>qarma.est</code> are</p>
<ul>
<li><strong>Y</strong> A (demeaned) matrix of observations, which contains only numeric values and no missing observations.</li>
<li><strong>model_order</strong> A list specifying the order of the QARMA to be estimated. This list should be of the form <code>list(ar = c(1, 1), ma = c(1, 1))</code>. Obviously, all orders should be non-negative integers. A QARMA<span class="math inline">\(((1,1), (1,1))\)</span> model is estimated by default, if <code>model_order</code> is omitted.</li>
</ul>
<p><code>qarma.est</code> returns an object of class <code>qarma</code> with attribute <code>&quot;subclass&quot; = &quot;est&quot;</code> including the following values:</p>
<ul>
<li><strong>Y</strong> The matrix of observations inherited from input.</li>
<li><strong>innov</strong> The matrix of estimated innovations from the Hannan-Rissanen algorithm.</li>
<li><strong>model</strong> A list of estimated model coefficients containing the matrices <code>ar</code> of autoregressive coefficients, the matrix <code>ma</code> of moving average coefficients as well as the standard deviation of residuals <code>sigma</code>.</li>
<li><strong>stnry</strong> Indicator variable (boolean) for stationarity of the process.</li>
</ul>
</div>
<div id="sfarima.sim" class="section level3 unnumbered">
<h3 class="unnumbered"><code>sfarima.sim</code></h3>
<p>Simulation of a (separable) spatial fractional ARIMA (SFARIMA) process. This function returns an object of class <code>sfarima</code> with attribute <code>&quot;subclass&quot; = &quot;sim&quot;</code>. The simulated innovations are created from a normal distribution with specified variance <span class="math inline">\(\sigma^2\)</span>. This function uses a burn-in period for more consistent results.</p>
<p>Arguments of <code>sfarima.sim</code> are</p>
<ul>
<li><strong>n_x</strong>, <strong>n_t</strong> The dimension of the resulting matrix of observations, where <code>n_x</code> specifies the number of rows and <code>n_t</code> the number of columns. Initially, a matrix of <span class="math inline">\(2 n_x \times 2 n_t\)</span> is simulated, of which simulation points with <span class="math inline">\(i \leq n_x\)</span> or <span class="math inline">\(j \leq n_t\)</span> are discarded (burn-in period).</li>
<li><strong>model</strong> A list containing the model parameters to be used in the simulation of the form <code>list(ar, ma, d, sigma)</code>. The values <code>ar</code> and <code>ma</code> are matrices of size <span class="math inline">\((p_x + 1) \times (p_t + 1)\)</span> respective <span class="math inline">\((q_x + 1) \times (q_t + 1)\)</span> and containing the coefficients in ascending lag order, so that the upper left entry is equal to 1 (for lag 0 in both dimensions). The long-memory parameters <span class="math inline">\(d_x, d_t\)</span> are stored in <code>d</code>, a numeical vector of length 2, with <span class="math inline">\(0 &lt; d_x, d_t &lt; 0.5\)</span>. The standard deviation of the iid. innovations with zero mean is <code>sigma</code>, which should be a single positive number. See the examples in the application part 3.3.</li>
</ul>
<p><code>sfarima.sim</code> returns an object of class <code>sfarima</code> with attribute <code>&quot;subclass&quot; = &quot;sim&quot;</code> including the following values:</p>
<ul>
<li><strong>Y</strong> The matrix of simulated values with size <span class="math inline">\(n_x \times n_t\)</span> (determined by function arguments <code>n_x</code>, <code>n_t</code>). The matrix <span class="math inline">\(Y\)</span> is the lower left <span class="math inline">\(n_x \times n_t\)</span> submatrix of the actually simulated matrix <span class="math inline">\(Y&#39;\)</span> of size <span class="math inline">\(2 n_x \times 2 n_t\)</span> to avoid effects from setting the initial values (“burn-in period”).</li>
<li><strong>innov</strong> The <span class="math inline">\(n_x \times n_t\)</span> matrix of iid. normally distributed innovations/errors of the QARMA model with zero mean and variance <span class="math inline">\(\sigma^2\)</span> (determined by the function argument <code>model\$sigma</code>). As with <code>Y</code>, the original matrix has size <span class="math inline">\(2 n_x \times 2 n_t\)</span>.</li>
<li><strong>model</strong> The model used for simulation, inherited from input.</li>
<li><strong>stnry</strong> Indicator variable (boolean) for stationarity of the process.</li>
</ul>
</div>
<div id="sfarima.est" class="section level3 unnumbered">
<h3 class="unnumbered"><code>sfarima.est</code></h3>
<p>Estimation of a top-left dependent spatial ARMA process (QARMA). This function minimizes the residual sum of squares (RSS) to estimate the SFARIMA-parameters of a given order. It returns an object of class <code>sfarima</code> with attribute <code>&quot;subclass&quot; = &quot;est&quot;</code>.</p>
<p>Arguments of <code>sfarima.est</code> are</p>
<ul>
<li><strong>Y</strong> A (demeaned) matrix of observations, which contains only numeric values and no missing observations.</li>
<li><strong>model_order</strong> A list specifying the order of the SFARIMA to be estimated. This list should be of the form <code>list(ar = c(1, 1), ma = c(1, 1))</code>. Obviously, all orders should be non-negative integers. A QARMA<span class="math inline">\(((1,1), (1,1))\)</span> model is estimated by default, if <code>model_order</code> is omitted.</li>
</ul>
<p><code>sfarima.est</code> returns an object of class <code>sfarima</code> with attribute <code>&quot;subclass&quot; = &quot;est&quot;</code> including the following values:</p>
<ul>
<li><strong>Y</strong> The matrix of observations inherited from input.</li>
<li><strong>innov</strong> The matrix of estimated innovations from the Hannan-Rissanen algorithm.</li>
<li><strong>model</strong> A list of estimated model coefficients containing the matrices <code>ar</code> of autoregressive coefficients, the matrix <code>ma</code> of moving average coefficients as well as the vector <code>d</code> holding the long-memory parameters and the standard deviation of residuals <code>sigma</code>.</li>
<li><strong>stnry</strong> Indicator variable (boolean) for stationarity of the process.</li>
</ul>
</div>
</div>
<div id="methods" class="section level2">
<h2>2.2 Methods</h2>
<p>The <em>DCSmooth</em> package contains the following methods</p>
<table>
<thead>
<tr class="header">
<th align="left"><span style="display: inline-block; width:170px">Function</span></th>
<th align="left"><span style="display: inline-block; width:500px">Methods/Generics available</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>set.options()</code></td>
<td align="left"><code>print</code>, <code>summary</code></td>
</tr>
<tr class="even">
<td align="left"><code>dcs()</code></td>
<td align="left"><code>plot</code>, <code>print</code>, <code>print.summary</code>, <code>residuals</code>, <code>summary</code></td>
</tr>
</tbody>
</table>
</div>
<div id="data" class="section level2">
<h2>2.3 Data</h2>
<p>There are three simulated example data sets included in the package. Each data set is a matrix of size <span class="math inline">\(101 \times 101\)</span> computed on <span class="math inline">\([0,1]^2\)</span> for the following functions:</p>
<ul>
<li><strong>y.norm1</strong> <span class="math display">\[\mathcal{N} \left( \begin{pmatrix} 0.5 \\ 0.5 \end{pmatrix}, \begin{pmatrix} 0.05 &amp; 0 \\ 0 &amp; 0.05 \end{pmatrix} \right)\]</span></li>
<li><strong>y.norm2</strong> <span class="math display">\[ \mathcal{N} \left( \begin{pmatrix} 0.5 \\ 0.3 \end{pmatrix}, \begin{pmatrix} 0.1 &amp; 0 \\ 0 &amp; 0.1 \end{pmatrix} \right) + \mathcal{N} \left( \begin{pmatrix} 0.2 \\ 0.8 \end{pmatrix}, \begin{pmatrix} 0.05 &amp; 0 \\ 0 &amp; 0.05 \end{pmatrix} \right) \]</span></li>
<li><strong>y.norm3</strong> <span class="math display">\[ \mathcal{N} \left( \begin{pmatrix} 0.25 \\ 0.75 \end{pmatrix}, \begin{pmatrix} 0.01 &amp; 0 \\ 0 &amp; -0.1 \end{pmatrix} \right) + \mathcal{N} \left( \begin{pmatrix} 0.75 \\ 0.5 \end{pmatrix}, \begin{pmatrix} 0.01 &amp; 0 \\ 0 &amp; -0.1 \end{pmatrix} \right)\]</span></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># surface.dcs(y.norm1)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># surface.dcs(y.norm2)</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># surface.dcs(y.norm3)</span></span></code></pre></div>
</div>
</div>
<div id="application" class="section level1">
<h1>3 Application</h1>
<p>The application of the package is demonstrated at the example of the simulated function values <code>y.norm1</code> which represent a gaussian peak on <span class="math inline">\([0,1]^2\)</span> with <span class="math inline">\(n_x = n_t = 101\)</span> evaluation points. Different models are simulated and estimation using <code>dcs</code> is demonstrated. Whenever default options are used, they are not explicitly used as function arguments, instead only when deviating from the defaults, the options are changed.</p>
<blockquote>
<p>Due to file size restrictions, the <code>surface.dcs</code> commands in this vignette are commented out. Run the complete code used in section 3 of this vignette by <code>demo(&quot;DCS_demo&quot;, package = &quot;DCSmooth&quot;)</code>.</p>
</blockquote>
<div id="application-of-the-dcs-with-iid.-errors" class="section level2">
<h2>3.1 Application of the DCS with iid. errors</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># surface.dcs(y.norm1)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>y_iid <span class="ot">=</span> y.norm1 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">101</span><span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># surface.dcs(y_iid)</span></span></code></pre></div>
<p>###* Kernel Regression with iid. errors While local linear regression has some clear advantages over kernel regression, kernel regression is the faster method. Currently, kernel regression is only available for the regression surface ($_x = _t = 0).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>opt_iid_KR <span class="ot">=</span> <span class="fu">set.options</span>(<span class="at">type =</span> <span class="st">&quot;KR&quot;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>dcs_iid_KR <span class="ot">=</span> <span class="fu">dcs</span>(y_iid, opt_iid_KR)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>dcs_iid_KR</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dcs </span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -------------------------------------- </span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DCS with automatic bandwidth selection</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -------------------------------------- </span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Selected Bandwidths:</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      h_x: 0.18855 </span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      h_t: 0.19259 </span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Variance Factor:</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      c_f: 0.99379 </span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co"># print options used for DCS procedure</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>dcs_iid_KR<span class="sc">$</span>dcs_options</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dcs_options </span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------- </span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; options for DCS  rows    cols </span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------- </span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; type: kernel regression </span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; kernels used:        MW_220  MW_220</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; derivative:      0   0</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; variance model:  iid</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="co"># plot regression surface</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="co"># surface.dcs(dcs_iid_KR, plot_choice = 2)</span></span></code></pre></div>
<p>The summary of the <code>&quot;dcs&quot;</code>-object provides some more detailed information:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dcs_iid_KR)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; summary_dcs </span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DCS with automatic bandwidth selection:</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Results of kernel regression:</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimated Bandwidths:     h_x:    0.1886 </span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           h_t:    0.1926 </span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Variance Factor:      c_f:    0.9938 </span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Iterations:           4 </span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time used (seconds):      0.03127 </span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Variance Estimation:      iid.</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; See used parameter with &quot;$dcs_options&quot;.</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------</span></span></code></pre></div>
<p>###* Local Polynomial regression with iid. errors This is the default method, specification of options is not necessary. Note that local polynomial regression requires the bandwidth to cover at least the number of observations of the polynomial order plus one. For small bandwidths or too few observation points in one dimension, local polynomial regression might fail (“Bandwidth h must be larger for local polynomial regression.”). It is suggested to use kernel regression in this case.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>dcs_LP_iid <span class="ot">=</span> <span class="fu">dcs</span>(y_iid)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>dcs_LP_iid</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dcs </span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -------------------------------------- </span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DCS with automatic bandwidth selection</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -------------------------------------- </span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Selected Bandwidths:</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      h_x: 0.17265 </span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      h_t: 0.19012 </span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Variance Factor:</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      c_f: 0.99364 </span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dcs_LP_iid)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; summary_dcs </span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DCS with automatic bandwidth selection:</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Results of local polynomial regression:</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimated Bandwidths:     h_x:    0.1727 </span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           h_t:    0.1901 </span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Variance Factor:      c_f:    0.9936 </span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Iterations:           9 </span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time used (seconds):      0.06252 </span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Variance Estimation:      iid.</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------ </span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; See used parameter with &quot;$dcs_options&quot;.</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="co"># plot regression surface</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="co"># surface.dcs(dcs_LP_iid, plot_choice = 2)</span></span></code></pre></div>
</div>
<div id="application-of-the-dcs-with-qarma-errors" class="section level2">
<h2>3.2 Application of the DCS with QARMA errors</h2>
<p>A matrix containing innovations following a QARMA<span class="math inline">\(((p_x, p_t), (q_x, q_t))\)</span> process can be obtained by the <code>qarma.sim</code> function. We use the following QARMA<span class="math inline">\(((1, 1), (1, 1))\)</span>-process as example: <span class="math display">\[
\begin{align}
AR = \begin{pmatrix} 1 &amp; 0.4 \\ -0.3 &amp; 0.2 \end{pmatrix}
\ \text{ and } \
MA = \begin{pmatrix} 1 &amp; 0.2 \\ 0.2 &amp; -0.5 \end{pmatrix}
\end{align}\\
\sigma^2 = 0.25
\]</span></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ar_mat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.4</span>, <span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">0.2</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>ma_mat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="sc">-</span><span class="fl">0.5</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>sigma  <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>model_list <span class="ot">=</span> <span class="fu">list</span>(<span class="at">ar =</span> ar_mat, <span class="at">ma =</span> ma_mat, <span class="at">sigma =</span> sigma)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>sim_qarma <span class="ot">=</span> <span class="fu">qarma.sim</span>(<span class="at">n_x =</span> <span class="dv">101</span>, <span class="at">n_t =</span> <span class="dv">101</span>, <span class="at">model =</span> model_list)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># QARMA observations</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>y_qarma <span class="ot">=</span> y.norm1 <span class="sc">+</span> sim_qarma<span class="sc">$</span>Y</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># surface.dcs(y_qarma)</span></span></code></pre></div>
<p>Estimation of an QARMA process for a given order works with the <code>qarma.est</code> function (note that the simulated matrix can be accessed via <code>$Y</code>):</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>estim_qarma <span class="ot">=</span> <span class="fu">qarma.est</span>(sim_qarma<span class="sc">$</span>Y, </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">model_order =</span> <span class="fu">list</span>(<span class="at">ar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">ma =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>estim_qarma<span class="sc">$</span>model</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ar</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           lag 0      lag 1</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 0 1.0000000 -0.3169031</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 1 0.4187407  0.1661860</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ma</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           lag 0      lag 1</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 0 1.0000000  0.1480133</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 1 0.2161155 -0.5244848</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $sigma</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.4964687</span></span></code></pre></div>
<p>###* Local Polynomial regression with specified QARMA order We use the <code>dcs</code>-command with the default QARMA<span class="math inline">\(((1, 1), (1, 1))\)</span> model (correctly specified) and with a QARMA<span class="math inline">\(((1, 1), (0, 0))\)</span> model:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># QARMA((1, 1), (1, 1))</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>opt_qarma_1 <span class="ot">=</span> <span class="fu">set.options</span>(<span class="at">var_est =</span> <span class="st">&quot;qarma&quot;</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>dcs_qarma_1 <span class="ot">=</span> <span class="fu">dcs</span>(y_qarma, opt_qarma_1)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>dcs_qarma_1</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dcs </span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -------------------------------------- </span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DCS with automatic bandwidth selection</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -------------------------------------- </span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Selected Bandwidths:</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      h_x: 0.1223 </span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      h_t: 0.14775 </span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Variance Factor:</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      c_f: 0.10348 </span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>dcs_qarma_1<span class="sc">$</span>var_model</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ar</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           lag 0      lag 1</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 0 1.0000000 -0.3163055</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 1 0.4163091  0.1681798</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ma</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           lag 0      lag 1</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 0 1.0000000  0.1441958</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 1 0.2091644 -0.5297148</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $sigma</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.4953101</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $stnry</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a><span class="co"># QARMA((1, 1), (0, 0))</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>order_list <span class="ot">=</span> <span class="fu">list</span>(<span class="at">ar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">ma =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>dcs_qarma_2 <span class="ot">=</span> <span class="fu">dcs</span>(y_qarma, opt_qarma_1, <span class="at">model_order =</span> order_list)</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>dcs_qarma_2</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dcs </span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -------------------------------------- </span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DCS with automatic bandwidth selection</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -------------------------------------- </span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Selected Bandwidths:</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      h_x: 0.13316 </span></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      h_t: 0.1605 </span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Variance Factor:</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      c_f: 0.15773 </span></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------</span></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>dcs_qarma_2<span class="sc">$</span>var_model</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ar</span></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           lag 0      lag 1</span></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 0 1.0000000 -0.2834914</span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 1 0.2742504  0.4218404</span></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ma</span></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       lag 0</span></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lag 0     1</span></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $sigma</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.561018</span></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $stnry</span></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<!-- ###* Local Polynomial regression with automated order selection -->
<!-- Automated order selection is selected with `var_est = "qarma_gpac"` or `var_est = "qarma_bic` in `set.options()`. The first one uses a generalized partial autocorrelation function for order selection, the second one is based on minimization of the BIC. Order selection for large data sets is slowly in general, however, the BIC variant is the slower among these two. -->
<!-- ```{r} -->
<!-- # GPAC -->
<!-- opt_qarma_3 = set.options(var_est = "qarma_gpac") -->
<!-- dcs_qarma_3 = dcs(y_qarma, opt_qarma_3) -->
<!-- dcs_qarma_3 -->
<!-- dcs_qarma_3$var_model -->
<!-- # BIC -->
<!-- opt_qarma_4 = set.options(var_est = "qarma_bic") -->
<!-- dcs_qarma_4 = dcs(y_qarma, opt_qarma_4) -->
<!-- dcs_qarma_4 -->
<!-- dcs_qarma_4$var_model -->
<!-- ``` -->
</div>
<div id="modelling-errors-with-long-memory" class="section level2">
<h2>3.3 Modelling errors with long memory</h2>
<p>This package includes a bandwidth selection algorithm when the errors <span class="math inline">\(\varepsilon(x, t)\)</span> follow a process with long memory. This process is modeled as SFARIMA. Surface estimation and the corresponding bandwidth selection under long-memory errors is currently in a experimental state.</p>
<p>We use the same spatial ARMA model as in 3.2 with long-memory parameters <span class="math inline">\(d = (0.3, 0.1)\)</span>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>ar_mat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.4</span>, <span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">0.2</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>ma_mat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="sc">-</span><span class="fl">0.5</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.1</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>sigma  <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>model_list <span class="ot">=</span> <span class="fu">list</span>(<span class="at">ar =</span> ar_mat, <span class="at">ma =</span> ma_mat, <span class="at">d =</span> d, <span class="at">sigma =</span> sigma)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>sim_sfarima <span class="ot">=</span> <span class="fu">sfarima.sim</span>(<span class="at">n_x =</span> <span class="dv">101</span>, <span class="at">n_t =</span> <span class="dv">101</span>, <span class="at">model =</span> model_list)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># SFARIMA surface observations</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>y_sfarima <span class="ot">=</span> y.norm1 <span class="sc">+</span> sim_sfarima<span class="sc">$</span>Y</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># surface.dcs(y_sfarima)</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>opt_lm <span class="ot">=</span> <span class="fu">set.options</span>(<span class="at">var_est =</span> <span class="st">&quot;lm&quot;</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimation under long-memory errors (SFARIMA) is currently in experimental state.</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>dcs_lm <span class="ot">=</span> <span class="fu">dcs</span>(y_sfarima, opt_lm)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>dcs_lm</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dcs </span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -------------------------------------- </span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DCS with automatic bandwidth selection</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -------------------------------------- </span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Selected Bandwidths:</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      h_x: 0.1628 </span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      h_t: 0.10863 </span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Variance Factor:</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      c_f: 0.012663 </span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>dcs_lm<span class="sc">$</span>var_model</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ar</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           [,1]        [,2]</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 1.0000000 -0.27127776</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,] 0.3489782 -0.09467001</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ma</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           [,1]       [,2]</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 1.0000000 0.22445028</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,] 0.1377722 0.03092302</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $d</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.3078662 0.1060895</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $sigma</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.4989074</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $stnry</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<!-- ## 3.4 Estimation of derivatives -->
<!-- Local polynomial estimation is suitable for estimation of derivatives of a function or a surface. While estimation of derivatives works as well under dependent errors, the example uses the iid. model from 3.1. Derivatives can be computed for any derivative vector `drv`, if the values are non-negative. Note that the order of the polynomials for the $\nu$th derivative is chosen to be $p_i = \nu_i + 1, i = x, t$. As bandwidths increase with the order of the derivatives, the bandwidth might be large for higher derivative orders. -->
<!-- The estimator for $m^{(1, 0)}(x, t)$ is given by -->
<!-- ```{r} -->
<!-- opt_drv_1 = set.options(drv = c(1, 0)) -->
<!-- dcs_drv_1 = dcs(y_iid, opt_drv_1) -->
<!-- dcs_drv_1 -->
<!-- # surface.dcs(dcs_drv_1, plot_choice = 2) -->
<!-- ``` -->
<!-- The estimator for $m^{(1, 2)}(x, t)$ is -->
<!-- ```{r} -->
<!-- opt_drv_2 = set.options(drv = c(1, 2)) -->
<!-- dcs_drv_2 = dcs(y_iid, opt_drv_2) -->
<!-- dcs_drv_2 -->
<!-- # surface.dcs(dcs_drv_2, plot_choice = 2) -->
<!-- ``` -->
</div>
</div>
<div id="mathematical-background" class="section level1">
<h1>4 Mathematical Background</h1>
<div id="double-conditional-smoothing" class="section level2">
<h2>4.1 Double Conditional Smoothing</h2>
<p>The double conditional smoothing is a spatial smoothing technique which effectively reduces the twodimensional estimation to two one-dimensional estimation procedures. The DCS is defined for kernel regression as well as for local polynomial regression.</p>
<p>Classical bivariate (and multivariate) regression has been considered e.g. by <span class="citation">Herrmann <em>et al.</em> (1995)</span> (kernel regression) and <span class="citation">Ruppert and Wand (1994)</span> (local polynomial regression). The DCS provides now a faster and, especially for equidistant data, more efficient smoothing scheme, which leads to reduced computation time. For the DCS procedure implemented in this package, consider a <span class="math inline">\((n_x \times n_t)\)</span>-matrix <span class="math inline">\(\mathbf{Y}\)</span> of non-empty observations <span class="math inline">\(u_{i,j}\)</span> and equidistant covariates <span class="math inline">\(X\)</span>, <span class="math inline">\(T\)</span> on <span class="math inline">\([0,1]\)</span>, where <span class="math inline">\(X\)</span> has length <span class="math inline">\(n_x\)</span> and <span class="math inline">\(T\)</span> has length <span class="math inline">\(n_t\)</span>. The model is then <span class="math display">\[
y_{i,j} = m(x_i, t_j) + \varepsilon_{i,j}
\]</span> where <span class="math inline">\(m(x, t)\)</span> is the mean or trend function, <span class="math inline">\(x_i \in X\)</span>, <span class="math inline">\(t_j \in T\)</span> and <span class="math inline">\(\varepsilon\)</span> is a random error function with zero mean. The model in matrix form is <span class="math inline">\(\mathbf{Y} = \mathbf{M}_1 + \mathbf{E}\)</span> at the observation points.</p>
<p>The main assumption of the DCS is that of product kernels, i.e. the weights in the respective methods are constructed by <span class="math inline">\(K(u,v) = K_1(u) K_2(v)\)</span>. Now, a two stage smoother can be constructed by either the kernel weights directly (kernel regression) or by using locally weighted regression with kernels <span class="math inline">\(K_1\)</span>, <span class="math inline">\(K_2\)</span>, in any case, the weights are called <span class="math inline">\(\mathbf{W}_x\)</span> and <span class="math inline">\(\mathbf{W}_t\)</span>. The DCS procedure implemented in <em>DCSmooth</em> smoothes over rows (conditioning on <span class="math inline">\(X\)</span>) first and then over columns (conditioning on <span class="math inline">\(T\)</span>), although switching the smoothing order is exactly equivalent. Hence, the DCS is given by the following equations: <span class="math display">\[
\begin{align*}
\mathbf{\widehat{M}}_0[ \ , j] &amp;= \mathbf{Y} \cdot \mathbf{W}_t[ \ , j] \\
\mathbf{\widehat{M}}_1[i, \ ] &amp;= \mathbf{W}_x [i, \ ] \cdot \mathbf{\widehat{M}}_0
\end{align*}
\]</span></p>
</div>
<div id="bandwidth-selection" class="section level2">
<h2>4.2 Bandwidth Selection</h2>
<p>The bandwidth vector <span class="math inline">\(h = (h_x, h_t)\)</span> is selected via an iterative plug-in (IPI) algorithm <span class="citation">(Gasser <em>et al.</em>, 1991)</span>. The IPI selects the optimal bandwidths by minimizing the mean integrated squared error (MISE) of the estimator. As the MISE includes derivatives of the regression surface <span class="math inline">\(m(x, t)\)</span>, auxiliary bandwidths for estimation of these derivatives are calculated via an inflation method. These inflation method connects the bandwidths of <span class="math inline">\(m(x, t)\)</span> with that of a derivative <span class="math inline">\(m^{(\nu_x, \nu_t)}(x, t)\)</span> by <span class="math display">\[
\widetilde{h}_k = c_k \cdot h_k^{\alpha}, \quad k = x, t
\]</span> and is called exponential inflation method (EIM). The values of <span class="math inline">\(c_k\)</span> are chosen on simulations, that of <span class="math inline">\(alpha\)</span> are subject to the derivative of interest. The IPI now starts with an initial bandwidth <span class="math inline">\(h_0\)</span> (chosen to be <span class="math inline">\(h_0 = (0.1, 0.1)\)</span>) and calculates in each step <span class="math inline">\(s\)</span> the auxiliary bandwidths <span class="math inline">\(\widetilde{h}_{k,s}\)</span> from <span class="math inline">\(h_{s-1}\)</span> and <span class="math inline">\(h_s\)</span> from the smoothed derivative surfaces using <span class="math inline">\(\widetilde{h}_{k,s}\)</span>. The iteration process finishes until a certain threshold is reached.</p>
</div>
<div id="boundary-modification" class="section level2">
<h2>4.3 Boundary Modification</h2>
<p>In kernel regression, the boundary problem exists, which leads to biased estimated at the boundaries of the regression surface. This problem can (partially) be solved by means of suitable boundary kernels as introduced by <span class="citation">Müller (1991)</span> and <span class="citation">Müller and Wang (1994)</span>. These boundary kernels differ in their degrees of smoothness and hence lead to different estimation results at the boundaries. However, all kernels are similar to the classical kernels in the interior region of the regression.</p>
<p>Following <span class="citation">Feng and Schäfer (2021)</span>, a boundary modification is also defined for local polynomial regression. In the <em>DCSmooth</em> package, the local polynomial regression is always with boundary modification weights. Kernel types available (either for kernel regression or local polynomial regression) are Müller-type, Müller-Wang-type and truncated kernels, denoted by <code>M</code>, <code>MW</code> and <code>T</code>. In most applications, the Müller-Wang type are the preferred weighting functions.</p>
</div>
<div id="spatial-arma-estimation" class="section level2">
<h2>4.4 Spatial ARMA estimation</h2>
<p>The spatial ARMA process used for modeling dependent errors is a QARMA process, which means, it has a top-left to bottom-right dependency <span class="citation">(Martin, 1996)</span>. For modeling a spatial ARMA process <span class="math inline">\(\varepsilon_{i,j}\)</span> the following equations hold: <span class="math display">\[
\phi(B_1, B_2)\varepsilon_{i,j} = \psi(B_1, B_2)\eta_{i,j},\\
\]</span> where the lag operators are <span class="math inline">\(B_1 \varepsilon_{i,j} = \varepsilon_{i-1, j}\)</span> and <span class="math inline">\(B_2 \varepsilon_{i,j} = \varepsilon_{i,j-1}\)</span>, <span class="math inline">\(\xi \underset{iid.}{\sim} \mathcal{N}(0,\sigma^2)\)</span> and <span class="math display">\[
\phi(z_1, z_2) = \sum_{m = 0}^{p_1} \sum_{n = 0}^{p_2} \phi_{m, n} z_1^m z_2^n, \ \psi(z_1, z_2) = \sum_{m = 0}^{q_1} \sum_{n = 0}^{q_2} \psi_{m, n} z_1^m z_2^n.
\]</span> The coefficients <span class="math inline">\(\psi_{m,n}\)</span> and <span class="math inline">\(\phi_{m,n}\)</span> are written in matrix form <span class="math display">\[
\begin{align*}
\boldsymbol{\phi} = \begin{pmatrix}
\phi_{0,0} &amp; \dots &amp; \phi_{0, p_2} \\
\vdots &amp; \ddots &amp; \\
\phi_{p_1, 0} &amp;  &amp; \phi_{p_1, p_2}
\end{pmatrix} \ \text{ and } \ \boldsymbol{\psi} = \begin{pmatrix}
\psi_{0, 0} &amp; \dots &amp; \psi_{0, q_2} \\
\vdots &amp; \ddots &amp; \\
\psi_{q_1, 0} &amp;  &amp; \psi_{q_1, q_2}
\end{pmatrix},
\end{align*}
\]</span> where <span class="math inline">\(\Phi\)</span> is the AR-part (<code>$var_model$ar</code>) and <span class="math inline">\(\Psi\)</span> is the MA-part (<code>$var_model$ma</code>). The example from 3.2, <span class="math display">\[
\begin{align}
\boldsymbol{\phi} = \begin{pmatrix} 1 &amp; 0.4 \\ -0.3 &amp; 0.2 \end{pmatrix}
\ \text{ and } \
\boldsymbol{\psi} = \begin{pmatrix} 1 &amp; 0.2 \\ 0.2 &amp; -0.5 \end{pmatrix}
\end{align},
\]</span> would then reduce to the process <span class="math display">\[
\varepsilon_{i,j} = 0.4\varepsilon_{i,j-1} - 0.3 \varepsilon_{i-,j} + 0.2\varepsilon_{i-1,j-1} + 0.2 \xi_{i,j-1} + 0.2 \xi_{i-1,j} -0.5 \xi_{i-1,j-1} + \xi_{i,j}.
\]</span></p>
</div>
</div>
<div id="appendix" class="section level1">
<h1>Appendix</h1>
<div id="a.1-kernels-available-in-the-dcsmooth-package" class="section level2">
<h2>A.1 Kernels available in the <em>DCSmooth</em> package:</h2>
<table>
<thead>
<tr class="header">
<th><span class="math inline">\(k\)</span></th>
<th><span class="math inline">\(\mu\)</span></th>
<th><span class="math inline">\(\nu\)</span></th>
<th>Truncated Kernels</th>
<th>Müller Kernels</th>
<th>Müller-Wang Kernels</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>0</td>
<td>0</td>
<td></td>
<td></td>
<td><code>MW_200</code></td>
</tr>
<tr class="even">
<td>2</td>
<td>1</td>
<td>0</td>
<td></td>
<td></td>
<td><code>MW_210</code></td>
</tr>
<tr class="odd">
<td>2</td>
<td>2</td>
<td>0</td>
<td></td>
<td></td>
<td><code>MW_220</code></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>3</td>
<td>2</td>
<td>0</td>
<td></td>
<td></td>
<td><code>MW_320</code></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>4</td>
<td>2</td>
<td>0</td>
<td><code>TR_420</code></td>
<td></td>
<td><code>MW_420</code></td>
</tr>
<tr class="even">
<td>4</td>
<td>2</td>
<td>1</td>
<td></td>
<td></td>
<td><code>MW_421</code></td>
</tr>
<tr class="odd">
<td>4</td>
<td>2</td>
<td>2</td>
<td><code>TR_422</code></td>
<td></td>
<td><code>MW_422</code></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-FengSchaefer2021" class="csl-entry">
Feng, Y. and Schäfer, B. (2021) Boundary modification in local polynomial regression and associated boundary kernel functions. <em>Preprint, Paderborn University</em>.
</div>
<div id="ref-Gasser1991" class="csl-entry">
Gasser, T., Kneip, A. and Köhler, W. (1991) A flexible and fast method for automatic smoothing. <em>Journal of the American Statistical Association</em>, <strong>86</strong>, 643–652.
</div>
<div id="ref-Herrmann1995" class="csl-entry">
Herrmann, E., Engel, J., Gasser, T., et al. (1995) A bandwidth selector for bivariate kernel regression. <em>Journal of the Royal Statistical Society</em>, <strong>57</strong>, 171–180.
</div>
<div id="ref-Martin1996" class="csl-entry">
Martin, R. J. (1996) Some results on unilateral ARMA lattice processes. <em>Journal of Statistical Planning and Inference</em>, <strong>50</strong>, 395–411.
</div>
<div id="ref-Mueller1991" class="csl-entry">
Müller, H.-G. (1991) Smooth optimum kernel estimators near endpoints. <em>Biometrika</em>, <strong>78</strong>, 521–530.
</div>
<div id="ref-MuellerWang1994" class="csl-entry">
Müller, H.-G. and Wang, J.-L. (1994) Hazard rate estimation under random censoring with varying kernels and bandwidths. <em>Biometrics</em>, <strong>50</strong>, 61–76.
</div>
<div id="ref-RuppertWand1994" class="csl-entry">
Ruppert, D. and Wand, M. P. (1994) Multivariate locally weighted least squares regression. <em>The Annals of Statistics</em>, <strong>22</strong>, 1346–1370.
</div>
<div id="ref-SchaeferFeng2020" class="csl-entry">
Schäfer, B. and Feng, Y. (2021) Fast computation and bandwidth selection algorithms for smoothing functional time series. <em>Preprint, Paderborn University</em>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
